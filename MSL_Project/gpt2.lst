TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 27 2021  Time: 10:04:06  Page:   1
gpt2

 LOC CODE        LINE   SOURCELINE

                     1   ; TASKING C166/ST10 C compiler v8.7r1 Build 775
                     2   ; options: -e -Id:\programme\tasking\c166 v8.7r1\include -x2 -Bhoeufmknladij -OB
                     3   ;          -OE -zswitch_tabmem_default -zautobitastruct-4 -zautobita-0 -FSC -A1
                     4   ;          -zvolatile_union -O0 -g -newerr -s -i0 -Ms
                     5   $DEBUG
                     6   $NOLOCALS
                     7   $EXTEND2
                     8   $NOMOD166
                     9   $STDNAMES(regsuper10bo.def)
                    10   $EXTMAC
                    11   $CASE
                    12   $NOEXPANDREGBANK
                    13   $MODEL(SMALL)
                    14           NAME    GPT2_C
                    15           ?SYMB   'gpt2.c',32,80,16
                    16           ?SYMB   '',1,82,0
                    17           ?SYMB   '80166',0,84,0
                    18           ?SYMB   '',0,81,0
                    19           ?SYMB   'void',00H,45,1
                    20           ?SYMB   'char',080000H,45,2
                    21           ?SYMB   'unsigned char',080000H,45,3
                    22           ?SYMB   'short',0100000H,45,4
                    23           ?SYMB   'unsigned short',0100000H,45,5
                    24           ?SYMB   'long',0200000H,45,6
                    25           ?SYMB   'unsigned long',0200000H,45,7
                    26           ?SYMB   'float',0200000H,45,10
                    27           ?SYMB   'double',0400000H,45,11
                    28           ?SYMB   'int',0100000H,45,16
                    29           ?SYMB   'unsigned int',0100000H,45,18
                    30           ?SYMB   'bit',010000H,7,256
                    31           ?SYMB   'gpt2.c',0,29,1
                    32           ?SYMB   '',0,86,1
                    33   ; gpt2.c      1 //****************************************************************************
                    34   ; gpt2.c      2 // @Module        General Purpose Timer Unit (GPT2)
                    35   ; gpt2.c      3 // @Filename      GPT2.C
                    36   ; gpt2.c      4 // @Project       DAvE_config.dav
                    37   ; gpt2.c      5 //----------------------------------------------------------------------------
                    38   ; gpt2.c      6 // @Controller    Infineon XE167F-96F66
                    39   ; gpt2.c      7 //
                    40   ; gpt2.c      8 // @Compiler      Tasking Classic
                    41   ; gpt2.c      9 //
                    42   ; gpt2.c     10 // @Codegenerator 2.2
                    43   ; gpt2.c     11 //
                    44   ; gpt2.c     12 // @Description   This file contains functions that use the GPT2 module.
                    45   ; gpt2.c     13 //
                    46   ; gpt2.c     14 //----------------------------------------------------------------------------
                    47   ; gpt2.c     15 // @Date          27.09.2021 10:03:55
                    48   ; gpt2.c     16 //
                    49   ; gpt2.c     17 //****************************************************************************
                    50   ; gpt2.c     18 
                    51   ; gpt2.c     19 // USER CODE BEGIN (GPT2_General,1)
                    52   ; gpt2.c     20 
                    53   ; gpt2.c     21 // USER CODE END
                    54   ; gpt2.c     22 
                    55   ; gpt2.c     23 
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 27 2021  Time: 10:04:06  Page:   2
gpt2

 LOC CODE        LINE   SOURCELINE

                    56   ; gpt2.c     24 
                    57   ; gpt2.c     25 //****************************************************************************
                    58   ; gpt2.c     26 // @Project Includes
                    59   ; gpt2.c     27 //****************************************************************************
                    60   ; gpt2.c     28 
                    61   ; gpt2.c     29 #include "MAIN.H"
                    62           ?SYMB   'MAIN.H',0,29,2
                    63           ?SYMB   '',0,86,2
                    64           ?SYMB   'XE16xREGS.H',0,29,3
                    65           ?SYMB   '',0,86,3
                    66           ?SYMB   '',0,86,2
                    67           ?SYMB   'SCS.H',0,29,3
                    68           ?SYMB   '',0,86,3
                    69           ?SYMB   'T$2',0,14,257
                    70           ?SYMB   'SCS_EXTCLK_F_SYS',0,33,257
                    71           ?SYMB   'SCS_EXTCLK_F_OUT',1,33,257
                    72           ?SYMB   'SCS_EXTCLK_F_PLL',2,33,257
                    73           ?SYMB   'SCS_EXTCLK_F_OSC',3,33,257
                    74           ?SYMB   'SCS_EXTCLK_F_WU',4,33,257
                    75           ?SYMB   'SCS_EXTCLK_F_TCK',5,33,257
                    76           ?SYMB   'SCS_EXTCLK_F_OSC_FL',6,33,257
                    77           ?SYMB   'SCS_EXTCLK_F_RTC',8,33,257
                    78           ?SYMB   '',16,16,0
                    79           ?SYMB   'SCS_EXTCLK_Type',257,13,258
                    80           ?SYMB   '',0,86,2
                    81           ?SYMB   'IO.H',0,29,3
                    82           ?SYMB   '',0,86,3
                    83           ?SYMB   '',0,86,2
                    84           ?SYMB   'GPT1.H',0,29,3
                    85           ?SYMB   '',0,86,3
                    86           ?SYMB   '',0,86,2
                    87           ?SYMB   'GPT2.H',0,29,3
                    88           ?SYMB   '',0,86,3
                    89           ?SYMB   '',0,86,2
                    90           ?SYMB   'CC2.H',0,29,3
                    91           ?SYMB   '',0,86,3
                    92           ?SYMB   '',0,86,2
                    93           ?SYMB   'CCU62.H',0,29,3
                    94           ?SYMB   '',0,86,3
                    95           ?SYMB   '',0,86,2
                    96           ?SYMB   'CCU63.H',0,29,3
                    97           ?SYMB   '',0,86,3
                    98           ?SYMB   '',0,86,2
                    99           ?SYMB   '',0,86,1
                   100   ; gpt2.c     30 
                   101   ; gpt2.c     31 // USER CODE BEGIN (GPT2_General,2)
                   102   ; gpt2.c     32 
                   103   ; gpt2.c     33 // USER CODE END
                   104   ; gpt2.c     34 
                   105   ; gpt2.c     35 
                   106   ; gpt2.c     36 //****************************************************************************
                   107   ; gpt2.c     37 // @Macros
                   108   ; gpt2.c     38 //****************************************************************************
                   109   ; gpt2.c     39 
                   110   ; gpt2.c     40 // USER CODE BEGIN (GPT2_General,3)
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 27 2021  Time: 10:04:06  Page:   3
gpt2

 LOC CODE        LINE   SOURCELINE

                   111   ; gpt2.c     41 
                   112   ; gpt2.c     42 // USER CODE END
                   113   ; gpt2.c     43 
                   114   ; gpt2.c     44 
                   115   ; gpt2.c     45 //****************************************************************************
                   116   ; gpt2.c     46 // @Defines
                   117   ; gpt2.c     47 //****************************************************************************
                   118   ; gpt2.c     48 
                   119   ; gpt2.c     49 // USER CODE BEGIN (GPT2_General,4)
                   120   ; gpt2.c     50 
                   121   ; gpt2.c     51 // USER CODE END
                   122   ; gpt2.c     52 
                   123   ; gpt2.c     53 
                   124   ; gpt2.c     54 //****************************************************************************
                   125   ; gpt2.c     55 // @Typedefs
                   126   ; gpt2.c     56 //****************************************************************************
                   127   ; gpt2.c     57 
                   128   ; gpt2.c     58 // USER CODE BEGIN (GPT2_General,5)
                   129   ; gpt2.c     59 
                   130   ; gpt2.c     60 // USER CODE END
                   131   ; gpt2.c     61 
                   132   ; gpt2.c     62 
                   133   ; gpt2.c     63 //****************************************************************************
                   134   ; gpt2.c     64 // @Imported Global Variables
                   135   ; gpt2.c     65 //****************************************************************************
                   136   ; gpt2.c     66 
                   137   ; gpt2.c     67 // USER CODE BEGIN (GPT2_General,6)
                   138   ; gpt2.c     68         extern const unsigned int ARRAY_SIZE;
                   139   ; gpt2.c     69         extern  unsigned int index;
                   140   ; gpt2.c     70 // USER CODE END
                   141   ; gpt2.c     71 
                   142   ; gpt2.c     72 
                   143   ; gpt2.c     73 //****************************************************************************
                   144   ; gpt2.c     74 // @Global Variables
                   145   ; gpt2.c     75 //****************************************************************************
                   146   ; gpt2.c     76 
                   147   ; gpt2.c     77 // USER CODE BEGIN (GPT2_General,7)
                   148   ; gpt2.c     78 
                   149   ; gpt2.c     79 // USER CODE END
                   150   ; gpt2.c     80 
                   151   ; gpt2.c     81 
                   152   ; gpt2.c     82 //****************************************************************************
                   153   ; gpt2.c     83 // @External Prototypes
                   154   ; gpt2.c     84 //****************************************************************************
                   155   ; gpt2.c     85 
                   156   ; gpt2.c     86 // USER CODE BEGIN (GPT2_General,8)
                   157   ; gpt2.c     87 
                   158   ; gpt2.c     88 // USER CODE END
                   159   ; gpt2.c     89 
                   160   ; gpt2.c     90 
                   161   ; gpt2.c     91 
                   162   ; gpt2.c     92 //****************************************************************************
                   163   ; gpt2.c     93 // @Prototypes Of Local Functions
                   164   ; gpt2.c     94 //****************************************************************************
                   165   ; gpt2.c     95 
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 27 2021  Time: 10:04:06  Page:   4
gpt2

 LOC CODE        LINE   SOURCELINE

                   166   ; gpt2.c     96 // USER CODE BEGIN (GPT2_General,9)
                   167   ; gpt2.c     97 
                   168   ; gpt2.c     98 // USER CODE END
                   169   ; gpt2.c     99 
                   170   ; gpt2.c    100 
                   171   ; gpt2.c    101 //****************************************************************************
                   172   ; gpt2.c    102 // @Function      void GPT2_vInit(void) 
                   173   ; gpt2.c    103 //
                   174   ; gpt2.c    104 //----------------------------------------------------------------------------
                   175   ; gpt2.c    105 // @Description   This is the initialization function of the GPT2 function 
                   176   ; gpt2.c    106 //                library. It is assumed that the SFRs used by this library 
                   177   ; gpt2.c    107 //                are in reset state. 
                   178   ; gpt2.c    108 //
                   179   ; gpt2.c    109 //----------------------------------------------------------------------------
                   180   ; gpt2.c    110 // @Returnvalue   None
                   181   ; gpt2.c    111 //
                   182   ; gpt2.c    112 //----------------------------------------------------------------------------
                   183   ; gpt2.c    113 // @Parameters    None
                   184   ; gpt2.c    114 //
                   185   ; gpt2.c    115 //----------------------------------------------------------------------------
                   186   ; gpt2.c    116 // @Date          27.09.2021
                   187   ; gpt2.c    117 //
                   188   ; gpt2.c    118 //****************************************************************************
                   189   ; gpt2.c    119 
                   190   ; gpt2.c    120 // USER CODE BEGIN (Init,1)
                   191   ; gpt2.c    121 
                   192   ; gpt2.c    122 // USER CODE END
                   193   ; gpt2.c    123 
                   194   ; gpt2.c    124 void GPT2_vInit(void)
                   195   ; gpt2.c    125 {
                   196   GPT2_1_PR       SECTION CODE WORD PUBLIC 'CPROGRAM'
                   197           ?LINE   125
                   198           PUBLIC  _GPT2_vInit
               R   199           ?SYMB   'GPT2_vInit',_GPT2_vInit,37,1
                   200           ?SYMB   '',125,8,34
                   201           ?SYMB   'uword',18,13,260
                   202   _GPT2_vInit     PROC    FAR
                   203           ?SYMB   '',00H,95,0
                   204   ; Locals:
                   205   ; 
                   206   ; Statics:
                   207   ; 
                   208   ; CSEs:
                   209   ; 
                   210   ; gpt2.c    126 
                   211   ; gpt2.c    127   // USER CODE BEGIN (Init,2)
                   212   ; gpt2.c    128 
                   213   ; gpt2.c    129   // USER CODE END
                   214   ; gpt2.c    130   ///  -----------------------------------------------------------------------
                   215   ; gpt2.c    131   ///  Configuration of Timer Block Prescaler 1:
                   216   ; gpt2.c    132   ///  -----------------------------------------------------------------------
                   217   ; gpt2.c    133   GPT12E_KSCCFG  =  0x0003;      // Module Enable
                   218           ?LINE   133
0000 E03C          219           MOV     R12,#03h
0002 F6FC1CFE      220           MOV     0FE1Ch,R12
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 27 2021  Time: 10:04:06  Page:   5
gpt2

 LOC CODE        LINE   SOURCELINE

                   221   ; gpt2.c    134 
                   222   ; gpt2.c    135 
                   223   ; gpt2.c    136   _nop();  // one cycle delay 
                   224           ?LINE   136
0006 CC00          225           NOP
                   226   ; gpt2.c    137 
                   227   ; gpt2.c    138   _nop();  // one cycle delay 
                   228           ?LINE   138
0008 CC00          229           NOP
                   230   ; gpt2.c    139 
                   231   ; gpt2.c    140 
                   232   ; gpt2.c    141   ///  -----------------------------------------------------------------------
                   233   ; gpt2.c    142   ///  Configuration of Timer Block Prescaler 2:
                   234   ; gpt2.c    143   ///  -----------------------------------------------------------------------
                   235   ; gpt2.c    144   ///  - prescaler for timer block 2 is 2
                   236   ; gpt2.c    145 
                   237   ; gpt2.c    146 
                   238   ; gpt2.c    147   ///  -----------------------------------------------------------------------
                   239   ; gpt2.c    148   ///  Configuration of the GPT2 Core Timer 5:
                   240   ; gpt2.c    149   ///  -----------------------------------------------------------------------
                   241   ; gpt2.c    150   ///  - timer 5 works in timer mode
                   242   ; gpt2.c    151   ///  - prescaler factor is 2
                   243   ; gpt2.c    152   ///  - up/down control bit is reset
                   244   ; gpt2.c    153   ///  - external up/down control is disabled
                   245   ; gpt2.c    154   ///  - timer 5 run bit is reset
                   246   ; gpt2.c    155   ///  - timer 5 remote control is disabled
                   247   ; gpt2.c    156 
                   248   ; gpt2.c    157   GPT12E_T5CON   =  0x0000;      // load timer 5 control register
                   249           ?LINE   157
000A E00C          250           MOV     R12,#00h
000C F6FC46FF      251           MOV     0FF46h,R12
                   252   ; gpt2.c    158   GPT12E_T5      =  0xFFFF;      // load timer 5 register
                   253           ?LINE   158
0010 E6FCFFFF      254           MOV     R12,#0FFFFh
0014 F6FC46FE      255           MOV     0FE46h,R12
                   256   ; gpt2.c    159 
                   257   ; gpt2.c    160   ///  -----------------------------------------------------------------------
                   258   ; gpt2.c    161   ///  Configuration of the GPT2 Core Timer 6:
                   259   ; gpt2.c    162   ///  -----------------------------------------------------------------------
                   260   ; gpt2.c    163   ///  - timer 6 works in timer mode
                   261   ; gpt2.c    164   ///  - prescaler factor is 2
                   262   ; gpt2.c    165   ///  - up/down control bit is reset
                   263   ; gpt2.c    166   ///  - external up/down control is disabled
                   264   ; gpt2.c    167   ///  - alternate output function T6OUT (P6.2) is disabled
                   265   ; gpt2.c    168   ///  - alternate output function T6OUT (P7.0) is disabled
                   266   ; gpt2.c    169   ///  - timer 6 output toggle latch (T6OTL) is set to 0
                   267   ; gpt2.c    170   ///  - timer 6 run bit is reset
                   268   ; gpt2.c    171   ///  - timer 6 is not cleared on a capture
                   269   ; gpt2.c    172 
                   270   ; gpt2.c    173   GPT12E_T6CON   =  0x0800;      // load timer 6 control register
                   271           ?LINE   173
0018 E6FC0008      272           MOV     R12,#0800h
001C F6FC48FF      273           MOV     0FF48h,R12
                   274   ; gpt2.c    174   GPT12E_T6      =  0xE3C1;      // load timer 6 register
                   275           ?LINE   174
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 27 2021  Time: 10:04:06  Page:   6
gpt2

 LOC CODE        LINE   SOURCELINE

0020 E6FCC1E3      276           MOV     R12,#0E3C1h
0024 F6FC48FE      277           MOV     0FE48h,R12
                   278   ; gpt2.c    175 
                   279   ; gpt2.c    176   ///  -----------------------------------------------------------------------
                   280   ; gpt2.c    177   ///  Configuration of the GPT2 CAPREL:
                   281   ; gpt2.c    178   ///  -----------------------------------------------------------------------
                   282   ; gpt2.c    179   ///  - capture T5 into CAPREL is disabled
                   283   ; gpt2.c    180   ///  - capture trigger from pin CAPIN
                   284   ; gpt2.c    181   ///  - capure is disabled
                   285   ; gpt2.c    182   ///  - timer 5 is not cleared on a capture
                   286   ; gpt2.c    183   ///  - timer 5 is just captured without any correction
                   287   ; gpt2.c    184 
                   288   ; gpt2.c    185   GPT12E_T5CON  |=  0x0000;      // load timer 5 control register
                   289           ?LINE   185
0028 E6FC46FF      290           MOV     R12,#0FF46h
002C A8CC          291           MOV     R12,[R12]
                   292   ; gpt2.c    186   GPT12E_CAPREL  =  0xE3C1;      // load CAPREL register
                   293           ?LINE   186
002E E6FCC1E3      294           MOV     R12,#0E3C1h
0032 F6FC4AFE      295           MOV     0FE4Ah,R12
                   296   ; gpt2.c    187 
                   297   ; gpt2.c    188   ///  -----------------------------------------------------------------------
                   298   ; gpt2.c    189   ///  Configuration of the used GPT2 Port Pins:
                   299   ; gpt2.c    190   ///  -----------------------------------------------------------------------
                   300   ; gpt2.c    191 
                   301   ; gpt2.c    192 
                   302   ; gpt2.c    193   ///  -----------------------------------------------------------------------
                   303   ; gpt2.c    194   ///  Configuration of the used GPT2 Interrupts:
                   304   ; gpt2.c    195   ///  -----------------------------------------------------------------------
                   305   ; gpt2.c    196 
                   306   ; gpt2.c    197 
                   307   ; gpt2.c    198   // USER CODE BEGIN (GPT2_Function,3)
                   308   ; gpt2.c    199 
                   309   ; gpt2.c    200   // USER CODE END
                   310   ; gpt2.c    201 
                   311   ; gpt2.c    202 } //  End of function GPT2_viCAPREL
                   312           ?LINE   202
0036 DB00          313           RETS
                   314   _GPT2_vInit     ENDP
               R   315           ?SYMB   '',$,17,202
                   316   ; gpt2.c    203 
                   317   ; gpt2.c    204 
                   318   ; gpt2.c    205 
                   319   ; gpt2.c    206 // USER CODE BEGIN (GPT2_General,10)
                   320   ; gpt2.c    207 
                   321   ; gpt2.c    208 // USER CODE END
                   322   ; gpt2.c    209 
                   323   GPT2_1_PR       ENDS
                   324   
                   325           REGDEF  R0-R15
                   326           END

total errors: 0, warnings: 0

