TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:   1
main

 LOC CODE        LINE   SOURCELINE

                     1   ; TASKING C166/ST10 C compiler v8.7r1 Build 775
                     2   ; options: -e -Id:\programme\tasking\c166 v8.7r1\include -x2 -Bhoeufmknladij -OB
                     3   ;          -OE -zswitch_tabmem_default -zautobitastruct-4 -zautobita-0 -FSC -A1
                     4   ;          -zvolatile_union -O0 -g -newerr -s -i0 -Ms
                     5   $DEBUG
                     6   $NOLOCALS
                     7   $EXTEND2
                     8   $NOMOD166
                     9   $STDNAMES(regsuper10bo.def)
                    10   $EXTMAC
                    11   $CASE
                    12   $NOEXPANDREGBANK
                    13   $MODEL(SMALL)
                    14           NAME    MAIN_C
                    15           ?SYMB   'main.c',32,80,16
                    16           ?SYMB   '',1,82,0
                    17           ?SYMB   '80166',0,84,0
                    18           ?SYMB   '',0,81,0
                    19           ?SYMB   'void',00H,45,1
                    20           ?SYMB   'char',080000H,45,2
                    21           ?SYMB   'unsigned char',080000H,45,3
                    22           ?SYMB   'short',0100000H,45,4
                    23           ?SYMB   'unsigned short',0100000H,45,5
                    24           ?SYMB   'long',0200000H,45,6
                    25           ?SYMB   'unsigned long',0200000H,45,7
                    26           ?SYMB   'float',0200000H,45,10
                    27           ?SYMB   'double',0400000H,45,11
                    28           ?SYMB   'int',0100000H,45,16
                    29           ?SYMB   'unsigned int',0100000H,45,18
                    30           ?SYMB   'bit',010000H,7,256
                    31           ?SYMB   'main.c',0,29,1
                    32           ?SYMB   '',0,86,1
                    33   ; main.c      1 //****************************************************************************
                    34   ; main.c      2 // @Module        Project Settings
                    35   ; main.c      3 // @Filename      MAIN.C
                    36   ; main.c      4 // @Project       DAvE_config.dav
                    37   ; main.c      5 //----------------------------------------------------------------------------
                    38   ; main.c      6 // @Controller    Infineon XE167F-96F66
                    39   ; main.c      7 //
                    40   ; main.c      8 // @Compiler      Tasking Classic
                    41   ; main.c      9 //
                    42   ; main.c     10 // @Codegenerator 2.2
                    43   ; main.c     11 //
                    44   ; main.c     12 // @Description   This file contains the project initialization function.
                    45   ; main.c     13 //
                    46   ; main.c     14 //----------------------------------------------------------------------------
                    47   ; main.c     15 // @Date          29.09.2021 09:41:08
                    48   ; main.c     16 //
                    49   ; main.c     17 //****************************************************************************
                    50   ; main.c     18 
                    51   ; main.c     19 // USER CODE BEGIN (MAIN_General,1)
                    52   ; main.c     20 
                    53   ; main.c     21 // USER CODE END
                    54   ; main.c     22 
                    55   ; main.c     23 
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:   2
main

 LOC CODE        LINE   SOURCELINE

                    56   ; main.c     24 
                    57   ; main.c     25 //****************************************************************************
                    58   ; main.c     26 // @Project Includes
                    59   ; main.c     27 //****************************************************************************
                    60   ; main.c     28 
                    61   ; main.c     29 #include "MAIN.H"
                    62           ?SYMB   'MAIN.H',0,29,2
                    63           ?SYMB   '',0,86,2
                    64           ?SYMB   'XE16xREGS.H',0,29,3
                    65           ?SYMB   '',0,86,3
                    66           ?SYMB   '',0,86,2
                    67           ?SYMB   'SCS.H',0,29,3
                    68           ?SYMB   '',0,86,3
                    69           ?SYMB   'T$2',0,14,257
                    70           ?SYMB   'SCS_EXTCLK_F_SYS',0,33,257
                    71           ?SYMB   'SCS_EXTCLK_F_OUT',1,33,257
                    72           ?SYMB   'SCS_EXTCLK_F_PLL',2,33,257
                    73           ?SYMB   'SCS_EXTCLK_F_OSC',3,33,257
                    74           ?SYMB   'SCS_EXTCLK_F_WU',4,33,257
                    75           ?SYMB   'SCS_EXTCLK_F_TCK',5,33,257
                    76           ?SYMB   'SCS_EXTCLK_F_OSC_FL',6,33,257
                    77           ?SYMB   'SCS_EXTCLK_F_RTC',8,33,257
                    78           ?SYMB   '',16,16,0
                    79           ?SYMB   'SCS_EXTCLK_Type',257,13,258
                    80           ?SYMB   '',0,86,2
                    81           ?SYMB   'IO.H',0,29,3
                    82           ?SYMB   '',0,86,3
                    83           ?SYMB   '',0,86,2
                    84           ?SYMB   'GPT1.H',0,29,3
                    85           ?SYMB   '',0,86,3
                    86           ?SYMB   '',0,86,2
                    87           ?SYMB   'GPT2.H',0,29,3
                    88           ?SYMB   '',0,86,3
                    89           ?SYMB   '',0,86,2
                    90           ?SYMB   'CCU62.H',0,29,3
                    91           ?SYMB   '',0,86,3
                    92           ?SYMB   '',0,86,2
                    93           ?SYMB   'CCU63.H',0,29,3
                    94           ?SYMB   '',0,86,3
                    95           ?SYMB   '',0,86,2
                    96           ?SYMB   'ADC0.H',0,29,3
                    97           ?SYMB   '',0,86,3
                    98           ?SYMB   'ubyte',3,13,259
                    99           ?SYMB   '',0,86,2
                   100           ?SYMB   '',0,86,1
                   101   ; main.c     30 
                   102   ; main.c     31 // USER CODE BEGIN (MAIN_General,2)
                   103   ; main.c     32 #include <math.h>
                   104           ?SYMB   'd:\programme\tasking\c166 v8.7r1\include\math.h',0,29,2
                   105           ?SYMB   '',0,86,2
                   106           ?SYMB   '',0,86,1
                   107   ; main.c     33 // USER CODE END
                   108   ; main.c     34 
                   109   ; main.c     35 
                   110   ; main.c     36 //****************************************************************************
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:   3
main

 LOC CODE        LINE   SOURCELINE

                   111   ; main.c     37 // @Macros
                   112   ; main.c     38 //****************************************************************************
                   113   ; main.c     39 
                   114   ; main.c     40 // USER CODE BEGIN (MAIN_General,3)
                   115   ; main.c     41 
                   116   ; main.c     42 // USER CODE END
                   117   ; main.c     43 
                   118   ; main.c     44 
                   119   ; main.c     45 //****************************************************************************
                   120   ; main.c     46 // @Defines
                   121   ; main.c     47 //****************************************************************************
                   122   ; main.c     48 
                   123   ; main.c     49 // USER CODE BEGIN (MAIN_General,4)
                   124   ; main.c     50         // clockwise=rechtslauf, counterclockwise=linkslauf
                   125   ; main.c     51         #define clockwise (0)
                   126   ; main.c     52         #define counterclockwise (1)
                   127   ; main.c     53 // USER CODE END
                   128   ; main.c     54 
                   129   ; main.c     55 
                   130   ; main.c     56 //****************************************************************************
                   131   ; main.c     57 // @Typedefs
                   132   ; main.c     58 //****************************************************************************
                   133   ; main.c     59 
                   134   ; main.c     60 // USER CODE BEGIN (MAIN_General,5)
                   135   ; main.c     61 
                   136   ; main.c     62 // USER CODE END
                   137   ; main.c     63 
                   138   ; main.c     64 
                   139   ; main.c     65 //****************************************************************************
                   140   ; main.c     66 // @Imported Global Variables
                   141   ; main.c     67 //****************************************************************************
                   142   ; main.c     68 
                   143   ; main.c     69 // USER CODE BEGIN (MAIN_General,6)
                   144   ; main.c     70 
                   145   ; main.c     71 // USER CODE END
                   146   ; main.c     72 
                   147   ; main.c     73 
                   148   ; main.c     74 //****************************************************************************
                   149   ; main.c     75 // @Global Variables
                   150   ; main.c     76 //****************************************************************************
                   151   ; main.c     77 
                   152   ; main.c     78 // USER CODE BEGIN (MAIN_General,7)
                   153   ; main.c     79         unsigned int frequency = 0;
                   154   MAIN_IR_NB      SECTION PDAT WORD PUBLIC 'CINITROM'
0000               155   MAIN_IR_NB_ENTRY        LABEL   BYTE
0000 0000          156           DW      00h
                   157   MAIN_IR_NB      ENDS
                   158   
                   159   MAIN_ID_NB      SECTION LDAT WORD PUBLIC 'CINITIRAM'
0000               160   MAIN_ID_NB_ENTRY        LABEL   BYTE
0000               161   _frequency      LABEL   WORD
0000               162           DS      2
                   163           PUBLIC  _frequency
               R   164           ?SYMB   'frequency',_frequency,22,18
                   165   ; main.c     80         const unsigned int ARRAY_SIZE = 1200;
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:   4
main

 LOC CODE        LINE   SOURCELINE

                   166   MAIN_ID_NB      ENDS
                   167   
                   168   MAIN_3_NC       SECTION LDAT WORD PUBLIC 'CNEARROM'
0000               169   _ARRAY_SIZE     LABEL   WORD
0000 B004          170           DW      04B0h
                   171           PUBLIC  _ARRAY_SIZE
               R   172           ?SYMB   'ARRAY_SIZE',_ARRAY_SIZE,22,18
                   173   ; main.c     81         unsigned int OFFSET_L1;
                   174   ; main.c     82         unsigned int OFFSET_L2;
                   175   ; main.c     83         unsigned int OFFSET_L3;
                   176   ; main.c     84         unsigned int table[ARRAY_SIZE];
                   177   ; main.c     85         unsigned int index;
                   178   ; main.c     86         float pi = 3.14159265359;
                   179   MAIN_3_NC       ENDS
                   180   
                   181   MAIN_IR_NB      SECTION PDAT
0002 4940DB0F      182           DW      04049h,0FDBh
                   183   MAIN_IR_NB      ENDS
                   184   
                   185   MAIN_ID_NB      SECTION LDAT
0002               186   _pi     LABEL   WORD
0002               187           DS      4
                   188           PUBLIC  _pi
               R   189           ?SYMB   'pi',_pi,22,10
                   190   ; main.c     87         volatile unsigned int rampIndex;
                   191   ; main.c     88         volatile float velocity;
                   192   ; main.c     89         volatile float rpm;
                   193   ; main.c     90         int integral_sum;
                   194   ; main.c     91         const float K_p = 0.05;
                   195   MAIN_ID_NB      ENDS
                   196   
                   197   MAIN_3_NC       SECTION LDAT
0002               198   _K_p    LABEL   WORD
0002 4C3DCDCC      199           DW      03D4Ch,0CCCDh
                   200           PUBLIC  _K_p
               R   201           ?SYMB   'K_p',_K_p,22,10
                   202   ; main.c     92         const float K_i = 0.01;
0006               203   _K_i    LABEL   WORD
0006 233C0AD7      204           DW      03C23h,0D70Ah
                   205           PUBLIC  _K_i
               R   206           ?SYMB   'K_i',_K_i,22,10
                   207   ; main.c     93 // USER CODE END
                   208   ; main.c     94 
                   209   ; main.c     95 
                   210   ; main.c     96 //****************************************************************************
                   211   ; main.c     97 // @External Prototypes
                   212   ; main.c     98 //****************************************************************************
                   213   ; main.c     99 
                   214   ; main.c    100 // USER CODE BEGIN (MAIN_General,8)
                   215   ; main.c    101 
                   216   ; main.c    102 // USER CODE END
                   217   ; main.c    103 
                   218   ; main.c    104 
                   219   ; main.c    105 //****************************************************************************
                   220   ; main.c    106 // @Prototypes Of Local Functions
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:   5
main

 LOC CODE        LINE   SOURCELINE

                   221   ; main.c    107 //****************************************************************************
                   222   ; main.c    108 
                   223   ; main.c    109 // USER CODE BEGIN (MAIN_General,9)
                   224   ; main.c    110 void generateTable();
                   225   ; main.c    111 unsigned int calculateMotorFrequency (unsigned int _frequency);
                   226   ; main.c    112 void setPhaseChange(int dir);
                   227   ; main.c    113 unsigned int controller(int input);
                   228   ; main.c    114 // USER CODE END
                   229   ; main.c    115 
                   230   ; main.c    116 
                   231   ; main.c    117 //****************************************************************************
                   232   ; main.c    118 // @Function      void MAIN_vInit(void) 
                   233   ; main.c    119 //
                   234   ; main.c    120 //----------------------------------------------------------------------------
                   235   ; main.c    121 // @Description   This function initializes the microcontroller.
                   236   ; main.c    122 //
                   237   ; main.c    123 //----------------------------------------------------------------------------
                   238   ; main.c    124 // @Returnvalue   None
                   239   ; main.c    125 //
                   240   ; main.c    126 //----------------------------------------------------------------------------
                   241   ; main.c    127 // @Parameters    None
                   242   ; main.c    128 //
                   243   ; main.c    129 //----------------------------------------------------------------------------
                   244   ; main.c    130 // @Date          29.09.2021
                   245   ; main.c    131 //
                   246   ; main.c    132 //****************************************************************************
                   247   ; main.c    133 
                   248   ; main.c    134 // USER CODE BEGIN (Init,1)
                   249   ; main.c    135 
                   250   ; main.c    136 // USER CODE END
                   251   ; main.c    137 
                   252   ; main.c    138 void MAIN_vInit(void)
                   253   ; main.c    139 {
                   254   MAIN_3_NC       ENDS
                   255   
                   256   MAIN_4_PR       SECTION CODE WORD PUBLIC 'CPROGRAM'
                   257           ?LINE   139
                   258           PUBLIC  _MAIN_vInit
               R   259           ?SYMB   'MAIN_vInit',_MAIN_vInit,37,1
                   260           ?SYMB   '',139,8,34
                   261           ?SYMB   '',010000H,7,261
                   262           ?SYMB   '',010001H,7,262
                   263           ?SYMB   '',010002H,7,263
                   264           ?SYMB   '',010003H,7,264
                   265           ?SYMB   '',010004H,7,265
                   266           ?SYMB   '',010005H,7,266
                   267           ?SYMB   '',010006H,7,267
                   268           ?SYMB   '',010007H,7,268
                   269           ?SYMB   '',010000H,7,269
                   270           ?SYMB   '',010001H,7,270
                   271           ?SYMB   '',010002H,7,271
                   272           ?SYMB   '',010003H,7,272
                   273           ?SYMB   '',010004H,7,273
                   274           ?SYMB   '',010005H,7,274
                   275           ?SYMB   '',010006H,7,275
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:   6
main

 LOC CODE        LINE   SOURCELINE

                   276           ?SYMB   '',010007H,7,276
                   277           ?SYMB   'T$1',0,40,277
                   278           ?SYMB   'bit0',0,23,261
                   279           ?SYMB   'bit1',1,23,262
                   280           ?SYMB   'bit2',2,23,263
                   281           ?SYMB   'bit3',3,23,264
                   282           ?SYMB   'bit4',4,23,265
                   283           ?SYMB   'bit5',5,23,266
                   284           ?SYMB   'bit6',6,23,267
                   285           ?SYMB   'bit7',7,23,268
                   286           ?SYMB   'bit8',8,23,269
                   287           ?SYMB   'bit9',9,23,270
                   288           ?SYMB   'bit10',10,23,271
                   289           ?SYMB   'bit11',11,23,272
                   290           ?SYMB   'bit12',12,23,273
                   291           ?SYMB   'bit13',13,23,274
                   292           ?SYMB   'bit14',14,23,275
                   293           ?SYMB   'bit15',15,23,276
                   294           ?SYMB   '',16,18,0
                   295           ?SYMB   'T_Reg16',277,13,278
                   296   _MAIN_vInit     PROC    FAR
                   297           ?SYMB   '',00H,95,0
                   298   ; Locals:
                   299   ; 
                   300   ; Statics:
                   301   ; 
                   302   ; CSEs:
                   303   ; 
                   304   ; main.c    140   // USER CODE BEGIN (Init,2)
                   305   ; main.c    141 
                   306   ; main.c    142   // USER CODE END
                   307   ; main.c    143 
                   308   ; main.c    144   //   globally disable interrupts
                   309   ; main.c    145   PSW_IEN        =  0;          
                   310           ?LINE   145
0000 E6FC10FF      311           MOV     R12,#0FF10h
0004 A8DC          312           MOV     R13,[R12]
0006 66FDFFF7      313           AND     R13,#0F7FFh
000A B8DC          314           MOV     [R12],R13
                   315   ; main.c    146 
                   316   ; main.c    147 
                   317   ; main.c    148   ///  -----------------------------------------------------------------------
                   318   ; main.c    149   ///  Configuration of the System Clock:
                   319   ; main.c    150   ///  -----------------------------------------------------------------------
                   320   ; main.c    151   ///  - VCO clock used, input clock is connected
                   321   ; main.c    152   ///  - input frequency is 10,00 MHz
                   322   ; main.c    153   ///  - configured system frequency is 66,00 MHz
                   323   ; main.c    154 
                   324   ; main.c    155   MAIN_vUnlockProtecReg();     // unlock write security
                   325           ?LINE   155
000C DA003E00  R   326           CALLS   SEG _MAIN_vUnlockProtecReg,_MAIN_vUnlockProtecReg
                   327   ; main.c    156 
                   328   ; main.c    157   MAIN_vChangeFreq();          // load PLL control register
                   329           ?LINE   157
0010 DA00D200  R   330           CALLS   SEG _MAIN_vChangeFreq,_MAIN_vChangeFreq
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:   7
main

 LOC CODE        LINE   SOURCELINE

                   331   ; main.c    158 
                   332   ; main.c    159   //   -----------------------------------------------------------------------
                   333   ; main.c    160   //   Initialization of the Peripherals:
                   334   ; main.c    161   //   -----------------------------------------------------------------------
                   335   ; main.c    162 
                   336   ; main.c    163   //   initializes the Parallel Ports
                   337   ; main.c    164   IO_vInit();
                   338           ?LINE   164
0014 DA000000  R   339           CALLS   SEG _IO_vInit,_IO_vInit
                   340   ; main.c    165 
                   341   ; main.c    166   //   initializes the General Purpose Timer Unit (GPT1)
                   342   ; main.c    167   GPT1_vInit();
                   343           ?LINE   167
0018 DA000000  R   344           CALLS   SEG _GPT1_vInit,_GPT1_vInit
                   345   ; main.c    168 
                   346   ; main.c    169   //   initializes the General Purpose Timer Unit (GPT2)
                   347   ; main.c    170   GPT2_vInit();
                   348           ?LINE   170
001C DA000000  R   349           CALLS   SEG _GPT2_vInit,_GPT2_vInit
                   350   ; main.c    171 
                   351   ; main.c    172   //   initializes the Capture / Compare Unit 62 (CCU62)
                   352   ; main.c    173   CCU62_vInit();
                   353           ?LINE   173
0020 DA000000  R   354           CALLS   SEG _CCU62_vInit,_CCU62_vInit
                   355   ; main.c    174 
                   356   ; main.c    175   //   initializes the Capture / Compare Unit 63 (CCU63)
                   357   ; main.c    176   CCU63_vInit();
                   358           ?LINE   176
0024 DA000000  R   359           CALLS   SEG _CCU63_vInit,_CCU63_vInit
                   360   ; main.c    177 
                   361   ; main.c    178   //   initializes the Analog / Digital Converter  (ADC0)
                   362   ; main.c    179   ADC0_vInit();
                   363           ?LINE   179
0028 DA000000  R   364           CALLS   SEG _ADC0_vInit,_ADC0_vInit
                   365   ; main.c    180 
                   366   ; main.c    181 
                   367   ; main.c    182   //   -----------------------------------------------------------------------
                   368   ; main.c    183   //   Initialization of the Bank Select registers:
                   369   ; main.c    184   //   -----------------------------------------------------------------------
                   370   ; main.c    185 
                   371   ; main.c    186 
                   372   ; main.c    187   // USER CODE BEGIN (Init,3)
                   373   ; main.c    188 
                   374   ; main.c    189   // USER CODE END
                   375   ; main.c    190 
                   376   ; main.c    191   MAIN_vLockProtecReg();       // lock write security
                   377           ?LINE   191
002C DA007800  R   378           CALLS   SEG _MAIN_vLockProtecReg,_MAIN_vLockProtecReg
                   379   ; main.c    192 
                   380   ; main.c    193   //   globally enable interrupts
                   381   ; main.c    194   PSW_IEN        =  1;          
                   382           ?LINE   194
0030 E6FC10FF      383           MOV     R12,#0FF10h
0034 A8DC          384           MOV     R13,[R12]
0036 1AFD0808      385           BFLDH   R13,#08h,#08h
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:   8
main

 LOC CODE        LINE   SOURCELINE

003A B8DC          386           MOV     [R12],R13
                   387   ; main.c    195 
                   388   ; main.c    196 } //  End of function MAIN_vInit
                   389           ?LINE   196
003C DB00          390           RETS
                   391   _MAIN_vInit     ENDP
               R   392           ?SYMB   '',$,17,196
                   393   ; main.c    197 
                   394   ; main.c    198 
                   395   ; main.c    199 //****************************************************************************
                   396   ; main.c    200 // @Function      void MAIN_vUnlockProtecReg(void) 
                   397   ; main.c    201 //
                   398   ; main.c    202 //----------------------------------------------------------------------------
                   399   ; main.c    203 // @Description   This function makes it possible to write one protected 
                   400   ; main.c    204 //                register.
                   401   ; main.c    205 //
                   402   ; main.c    206 //----------------------------------------------------------------------------
                   403   ; main.c    207 // @Returnvalue   None
                   404   ; main.c    208 //
                   405   ; main.c    209 //----------------------------------------------------------------------------
                   406   ; main.c    210 // @Parameters    None
                   407   ; main.c    211 //
                   408   ; main.c    212 //----------------------------------------------------------------------------
                   409   ; main.c    213 // @Date          29.09.2021
                   410   ; main.c    214 //
                   411   ; main.c    215 //****************************************************************************
                   412   ; main.c    216 
                   413   ; main.c    217 // USER CODE BEGIN (UnlockProtecReg,1)
                   414   ; main.c    218 
                   415   ; main.c    219 // USER CODE END
                   416   ; main.c    220 
                   417   ; main.c    221 void MAIN_vUnlockProtecReg(void)
                   418   ; main.c    222 {
                   419           ?LINE   222
                   420           PUBLIC  _MAIN_vUnlockProtecReg
               R   421           ?SYMB   'MAIN_vUnlockProtecReg',_MAIN_vUnlockProtecReg,37,1
                   422           ?SYMB   '',222,8,34
                   423           ?SYMB   'uword',18,13,280
                   424   _MAIN_vUnlockProtecReg  PROC    FAR
                   425           ?SYMB   '',00H,95,0
003E 2802          426           SUB     R0,#02h
               R   427           ?SYMB   '',$,96,2
                   428   ; Locals:
                   429   ;     uwPASSWORD = offset 0
                   430   ; 
                   431   ; Statics:
                   432   ; 
                   433   ; CSEs:
                   434   ; 
                   435   ; main.c    223   uword uwPASSWORD;
                   436           ?SYMB   'uwPASSWORD',1,98,280
               R   437           ?SYMB   '-2',$,101,1
                   438   ; main.c    224 
                   439   ; main.c    225     SCU_SLC = 0xAAAA;                   // command 0
                   440           ?LINE   225
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:   9
main

 LOC CODE        LINE   SOURCELINE

0040 E6FCAAAA      441           MOV     R12,#0AAAAh
0044 F6FCC0F0      442           MOV     0F0C0h,R12
                   443   ; main.c    226     SCU_SLC = 0x5554;                   // command 1
                   444           ?LINE   226
0048 E6FC5455      445           MOV     R12,#05554h
004C F6FCC0F0      446           MOV     0F0C0h,R12
                   447   ; main.c    227 
                   448   ; main.c    228     uwPASSWORD = SCU_SLS & 0x00FF;
                   449           ?LINE   228
0050 F2FCC2F0      450           MOV     R12,0F0C2h
0054 66FCFF00      451           AND     R12,#0FFh
0058 B8C0          452           MOV     [R0],R12
                   453   ; main.c    229     uwPASSWORD = (~uwPASSWORD) & 0x00FF;
                   454           ?LINE   229
005A A8C0          455           MOV     R12,[R0]
005C 91C0          456           CPL     R12
005E 66FCFF00      457           AND     R12,#0FFh
0062 B8C0          458           MOV     [R0],R12
                   459   ; main.c    230 
                   460   ; main.c    231     SCU_SLC = 0x9600 | uwPASSWORD;      // command 2
                   461           ?LINE   231
0064 A8C0          462           MOV     R12,[R0]
0066 76FC0096      463           OR      R12,#09600h
006A F6FCC0F0      464           MOV     0F0C0h,R12
                   465   ; main.c    232     SCU_SLC = 0x0000;                   // command 3
                   466           ?LINE   232
006E E00C          467           MOV     R12,#00h
0070 F6FCC0F0      468           MOV     0F0C0h,R12
                   469   ; main.c    233 
                   470   ; main.c    234 } //  End of function MAIN_vUnlockProtecReg
               R   471           ?SYMB   '',$,102,1
                   472           ?LINE   234
0074 0802          473           ADD     R0,#02h
               R   474           ?SYMB   '',$,96,0
0076 DB00          475           RETS
                   476   _MAIN_vUnlockProtecReg  ENDP
               R   477           ?SYMB   '',$,17,234
                   478   ; main.c    235 
                   479   ; main.c    236 
                   480   ; main.c    237 //****************************************************************************
                   481   ; main.c    238 // @Function      void MAIN_vLockProtecReg(void) 
                   482   ; main.c    239 //
                   483   ; main.c    240 //----------------------------------------------------------------------------
                   484   ; main.c    241 // @Description   This function makes it possible to lock one protected 
                   485   ; main.c    242 //                register.
                   486   ; main.c    243 //
                   487   ; main.c    244 //----------------------------------------------------------------------------
                   488   ; main.c    245 // @Returnvalue   None
                   489   ; main.c    246 //
                   490   ; main.c    247 //----------------------------------------------------------------------------
                   491   ; main.c    248 // @Parameters    None
                   492   ; main.c    249 //
                   493   ; main.c    250 //----------------------------------------------------------------------------
                   494   ; main.c    251 // @Date          29.09.2021
                   495   ; main.c    252 //
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  10
main

 LOC CODE        LINE   SOURCELINE

                   496   ; main.c    253 //****************************************************************************
                   497   ; main.c    254 
                   498   ; main.c    255 // USER CODE BEGIN (LockProtecReg,1)
                   499   ; main.c    256 
                   500   ; main.c    257 // USER CODE END
                   501   ; main.c    258 
                   502   ; main.c    259 void MAIN_vLockProtecReg(void)
                   503   ; main.c    260 {
                   504           ?LINE   260
                   505           PUBLIC  _MAIN_vLockProtecReg
               R   506           ?SYMB   'MAIN_vLockProtecReg',_MAIN_vLockProtecReg,37,1
                   507           ?SYMB   '',260,8,34
                   508   _MAIN_vLockProtecReg    PROC    FAR
                   509           ?SYMB   '',00H,95,0
0078 2802          510           SUB     R0,#02h
               R   511           ?SYMB   '',$,96,2
                   512   ; Locals:
                   513   ;     uwPASSWORD = offset 0
                   514   ; 
                   515   ; Statics:
                   516   ; 
                   517   ; CSEs:
                   518   ; 
                   519   ; main.c    261   uword uwPASSWORD;
                   520           ?SYMB   'uwPASSWORD',1,98,280
               R   521           ?SYMB   '-2',$,101,1
                   522   ; main.c    262 
                   523   ; main.c    263     SCU_SLC = 0xAAAA;                   // command 0
                   524           ?LINE   263
007A E6FCAAAA      525           MOV     R12,#0AAAAh
007E F6FCC0F0      526           MOV     0F0C0h,R12
                   527   ; main.c    264     SCU_SLC = 0x5554;                   // command 1
                   528           ?LINE   264
0082 E6FC5455      529           MOV     R12,#05554h
0086 F6FCC0F0      530           MOV     0F0C0h,R12
                   531   ; main.c    265 
                   532   ; main.c    266     uwPASSWORD = SCU_SLS & 0x00FF;
                   533           ?LINE   266
008A F2FCC2F0      534           MOV     R12,0F0C2h
008E 66FCFF00      535           AND     R12,#0FFh
0092 B8C0          536           MOV     [R0],R12
                   537   ; main.c    267     uwPASSWORD = (~uwPASSWORD) & 0x00FF;
                   538           ?LINE   267
0094 A8C0          539           MOV     R12,[R0]
0096 91C0          540           CPL     R12
0098 66FCFF00      541           AND     R12,#0FFh
009C B8C0          542           MOV     [R0],R12
                   543   ; main.c    268 
                   544   ; main.c    269     SCU_SLC = 0x9600 | uwPASSWORD;      // command 2
                   545           ?LINE   269
009E A8C0          546           MOV     R12,[R0]
00A0 76FC0096      547           OR      R12,#09600h
00A4 F6FCC0F0      548           MOV     0F0C0h,R12
                   549   ; main.c    270     SCU_SLC = 0x1800;                   // command 3; new PASSWOR is 0x00
                   550           ?LINE   270
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  11
main

 LOC CODE        LINE   SOURCELINE

00A8 E6FC0018      551           MOV     R12,#01800h
00AC F6FCC0F0      552           MOV     0F0C0h,R12
                   553   ; main.c    271 
                   554   ; main.c    272     uwPASSWORD = SCU_SLS & 0x00FF;
                   555           ?LINE   272
00B0 F2FCC2F0      556           MOV     R12,0F0C2h
00B4 66FCFF00      557           AND     R12,#0FFh
00B8 B8C0          558           MOV     [R0],R12
                   559   ; main.c    273     uwPASSWORD = (~uwPASSWORD) & 0x00FF;
                   560           ?LINE   273
00BA A8C0          561           MOV     R12,[R0]
00BC 91C0          562           CPL     R12
00BE 66FCFF00      563           AND     R12,#0FFh
00C2 B8C0          564           MOV     [R0],R12
                   565   ; main.c    274     SCU_SLC = 0x8E00 | uwPASSWORD;      // command 4
                   566           ?LINE   274
00C4 A8C0          567           MOV     R12,[R0]
00C6 76FC008E      568           OR      R12,#08E00h
00CA F6FCC0F0      569           MOV     0F0C0h,R12
                   570   ; main.c    275 
                   571   ; main.c    276 } //  End of function MAIN_vLockProtecReg
               R   572           ?SYMB   '',$,102,1
                   573           ?LINE   276
00CE 0802          574           ADD     R0,#02h
               R   575           ?SYMB   '',$,96,0
00D0 DB00          576           RETS
                   577   _MAIN_vLockProtecReg    ENDP
               R   578           ?SYMB   '',$,17,276
                   579   ; main.c    277 
                   580   ; main.c    278 
                   581   ; main.c    279 //****************************************************************************
                   582   ; main.c    280 // @Function      void MAIN_vChangeFreq(void) 
                   583   ; main.c    281 //
                   584   ; main.c    282 //----------------------------------------------------------------------------
                   585   ; main.c    283 // @Description   This function is used to select the external crystal and
                   586   ; main.c    284 //                configure the system frequency to 80Mhz/66Mhz.
                   587   ; main.c    285 //
                   588   ; main.c    286 //----------------------------------------------------------------------------
                   589   ; main.c    287 // @Returnvalue   None
                   590   ; main.c    288 //
                   591   ; main.c    289 //----------------------------------------------------------------------------
                   592   ; main.c    290 // @Parameters    None
                   593   ; main.c    291 //
                   594   ; main.c    292 //----------------------------------------------------------------------------
                   595   ; main.c    293 // @Date          29.09.2021
                   596   ; main.c    294 //
                   597   ; main.c    295 //****************************************************************************
                   598   ; main.c    296 
                   599   ; main.c    297 // USER CODE BEGIN (ChangeFreq,1)
                   600   ; main.c    298 
                   601   ; main.c    299 // USER CODE END
                   602   ; main.c    300 
                   603   ; main.c    301 void MAIN_vChangeFreq(void)
                   604   ; main.c    302 {
                   605           ?LINE   302
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  12
main

 LOC CODE        LINE   SOURCELINE

                   606           PUBLIC  _MAIN_vChangeFreq
               R   607           ?SYMB   'MAIN_vChangeFreq',_MAIN_vChangeFreq,37,1
                   608           ?SYMB   '',302,8,34
                   609   _MAIN_vChangeFreq       PROC    FAR
                   610           ?SYMB   '',00H,95,0
                   611   ; Locals:
                   612   ; 
                   613   ; Statics:
                   614   ; 
                   615   ; CSEs:
                   616   ; 
                   617   ; main.c    303   SCS_SwitchToHighPrecBandgap();
                   618           ?LINE   303
00D2 DA000000  R   619           CALLS   SEG _SCS_SwitchToHighPrecBandgap,_SCS_SwitchToHighPrecBandgap
                   620   ; main.c    304 
                   621   ; main.c    305   //For application and internal application resets, the complete PLL configura
                         tion could be avoided
                   622   ; main.c    306   //The entry from application resets and internal application reset is covered
                          in the following differentiation
                   623   ; main.c    307   //in int/ext clock in lock/unlocked state.
                   624   ; main.c    308 
                   625   ; main.c    309   if  ((SCU_PLLSTAT & 0x0004) == 0x0004)             // fR derived from Interna
                         l clock
                   626           ?LINE   309
00D6 F2FCBCF0      627           MOV     R12,0F0BCh
00DA 9AFC0720      628           JNB     R12.2,_7
                   629   ; main.c    310         {
                   630   ; main.c    311             //Normal startup state during boot and the clock
                   631   ; main.c    312             //has to be in the next step configured on the external crystal
                   632   ; main.c    313             //use XTAL/VCO, count XTAL clock
                   633   ; main.c    314 
                   634   ; main.c    315             SCS_StartXtalOsc(1);                     // Starts the crystal osci
                         llator
                   635           ?LINE   315
00DE E01C          636           MOV     R12,#01h
00E0 DA000000  R   637           CALLS   SEG _SCS_StartXtalOsc,_SCS_StartXtalOsc
                   638   ; main.c    316             SCS_SwitchSystemClock(1);                // System clock is increas
                         ed to target speed (80/66 MHz)
                   639           ?LINE   316
00E4 E01C          640           MOV     R12,#01h
00E6 DA000000  R   641           CALLS   SEG _SCS_SwitchSystemClock,_SCS_SwitchSystemClock
                   642   ; main.c    317 
                   643   ; main.c    318         }
                   644           ?LINE   318
00EA DB00          645           RETS
00EC               646   _7:
                   647   ; main.c    319 
                   648   ; main.c    320   else                                               // fR derived from externa
                         l crystal clock
                   649   ; main.c    321         {
                   650   ; main.c    322             if ((SCU_PLLSTAT & 0x1009) == 0x1009)    // fR derived from externa
                         l crystal clock + VCO is locked
                   651           ?LINE   322
00EC F2FCBCF0      652           MOV     R12,0F0BCh
00F0 66FC0910      653           AND     R12,#01009h
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  13
main

 LOC CODE        LINE   SOURCELINE

00F4 46FC0910      654           CMP     R12,#01009h
00F8 3D02          655           JMPR    cc_NE,_8
                   656   ; main.c    323             {
                   657   ; main.c    324                //usually after an application reset where clock need not be con
                         figured again.
                   658   ; main.c    325                //check K2/P/N values and decide whether these values have to be
                          adapted based on application needs.
                   659   ; main.c    326                NOP();
                   660           ?LINE   326
00FA CC00          661           NOP
                   662   ; main.c    327                //usually the PLL losss of Lock TRAP schould be enabled here.
                   663   ; main.c    328             }
                   664           ?LINE   328
00FC 0D01          665           JMPR    cc_UC,_9
00FE               666   _8:
                   667   ; main.c    329             else                                     //fR derived from external
                          crystal clock + VCO is not locked
                   668   ; main.c    330 
                   669   ; main.c    331             {
                   670   ; main.c    332                //estimate the K1 value and the current frequency
                   671   ; main.c    333                //reduce K2/P/N values in steps so that the frequency
                   672   ; main.c    334                //jumps is limited to 20MHz or factor of 5 whichever is minimum
                   673   ; main.c    335                NOP();
                   674           ?LINE   335
00FE CC00          675           NOP
                   676   ; main.c    336             }
                   677           ?LINE   336
0100               678   _9:
                   679   ; main.c    337 
                   680   ; main.c    338 
                   681   ; main.c    339         }
                   682           ?LINE   339
0100               683   _10:
                   684   ; main.c    340 
                   685   ; main.c    341 } //  End of function MAIN_vChangeFreq
                   686           ?LINE   341
0100 DB00          687           RETS
                   688   _MAIN_vChangeFreq       ENDP
               R   689           ?SYMB   '',$,17,341
                   690   ; main.c    342 
                   691   ; main.c    343 
                   692   ; main.c    344 //****************************************************************************
                   693   ; main.c    345 // @Function      void main(void) 
                   694   ; main.c    346 //
                   695   ; main.c    347 //----------------------------------------------------------------------------
                   696   ; main.c    348 // @Description   This is the main function.
                   697   ; main.c    349 //
                   698   ; main.c    350 //----------------------------------------------------------------------------
                   699   ; main.c    351 // @Returnvalue   None
                   700   ; main.c    352 //
                   701   ; main.c    353 //----------------------------------------------------------------------------
                   702   ; main.c    354 // @Parameters    None
                   703   ; main.c    355 //
                   704   ; main.c    356 //----------------------------------------------------------------------------
                   705   ; main.c    357 // @Date          29.09.2021
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  14
main

 LOC CODE        LINE   SOURCELINE

                   706   ; main.c    358 //
                   707   ; main.c    359 //****************************************************************************
                   708   ; main.c    360 
                   709   ; main.c    361 // USER CODE BEGIN (Main,1)
                   710   ; main.c    362 
                   711   ; main.c    363 // USER CODE END
                   712   ; main.c    364 
                   713   ; main.c    365 void main(void)
                   714   ; main.c    366 {
                   715           ?LINE   366
                   716           PUBLIC  _main
               R   717           ?SYMB   'main',_main,37,1
                   718           ?SYMB   '',366,8,34
                   719   _main   PROC    FAR
                   720           ?SYMB   '',00H,95,0
0102 2804          721           SUB     R0,#04h
               R   722           ?SYMB   '',$,96,4
                   723   ; Locals:
                   724   ;     raw = offset 0
                   725   ; 
                   726   ; Statics:
                   727   ; 
                   728   ; CSEs:
                   729   ; 
                   730   ; main.c    367   // USER CODE BEGIN (Main,2)
                   731   ; main.c    368 
                   732   ; main.c    369   // USER CODE END
                   733   ; main.c    370 
                   734   ; main.c    371   MAIN_vInit();
                   735           ?LINE   371
0104 DA000000  R   736           CALLS   SEG _MAIN_vInit,_MAIN_vInit
                   737   ; main.c    372 
                   738   ; main.c    373   // USER CODE BEGIN (Main,3)
                   739   ; main.c    374         generateTable();
                   740           ?LINE   374
0108 DA008403  R   741           CALLS   SEG _generateTable,_generateTable
                   742   ; main.c    375         ADC0_vInit();
                   743           ?LINE   375
010C DA000000  R   744           CALLS   SEG _ADC0_vInit,_ADC0_vInit
                   745   ; main.c    376         ADC0_vStartSeq0ReqChNum(0,0,1,6);
                   746           ?LINE   376
0110 E00C          747           MOV     R12,#00h
0112 E00D          748           MOV     R13,#00h
0114 E01E          749           MOV     R14,#01h
0116 E06F          750           MOV     R15,#06h
0118 DA000000  R   751           CALLS   SEG _ADC0_vStartSeq0ReqChNum,_ADC0_vStartSeq0ReqChNum
                   752   ; main.c    377         CCU63_vStartTmr(CCU63_TIMER_12);
                   753           ?LINE   377
011C E6FCA6EB      754           MOV     R12,#0EBA6h
0120 A8DC          755           MOV     R13,[R12]
0122 1FFD          756           BSET    R13.1
0124 B8DC          757           MOV     [R12],R13
                   758   ; main.c    378         CCU62_vStartTmr(CCU62_TIMER_12);
                   759           ?LINE   378
0126 E6FC26EB      760           MOV     R12,#0EB26h
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  15
main

 LOC CODE        LINE   SOURCELINE

012A A8DC          761           MOV     R13,[R12]
012C 1FFD          762           BSET    R13.1
012E B8DC          763           MOV     [R12],R13
                   764   ; main.c    379         GPT2_vStartTmr(GPT2_TIMER_6);
                   765           ?LINE   379
0130 E6FC48FF      766           MOV     R12,#0FF48h
0134 A8DC          767           MOV     R13,[R12]
0136 0AFD4040      768           BFLDL   R13,#040h,#040h
013A B8DC          769           MOV     [R12],R13
                   770   ; main.c    380   // USER CODE END
                   771   ; main.c    381 
                   772   ; main.c    382   while(1)
                   773           ?LINE   382
013C EA007C03  R   774           JMPA+   cc_UC,_48
0140               775   _30:
                   776   ; main.c    383   {
                   777   ; main.c    384 
                   778   ; main.c    385    // USER CODE BEGIN (Main,4)
                   779   ; main.c    386    
                   780   ; main.c    387    // one rampIndex step = 8ms, 250 steps = 2s
                   781   ; main.c    388    if (rampIndex > 1750){
                   782           ?LINE   388
0140 F2FC0000  R   783           MOV     R12,_rampIndex
0144 46FCD606      784           CMP     R12,#06D6h
0148 FD2D          785           JMPR    cc_ULE,_31
                   786   ; main.c    389                 unsigned long raw;
               R   787           ?SYMB   '',$,9,389
                   788           ?SYMB   'raw',1,98,7
               R   789           ?SYMB   '-4',$,101,1
                   790   ; main.c    390                 raw = ADC0_uwGetResultData(RESULT_REG_0);
                   791           ?LINE   390
014A F2FCB0E0      792           MOV     R12,0E0B0h
014E 9AFC07C0      793           JNB     R12.12,_49
0152 0D00          794           JMPR    cc_UC,_50
0154               795   _50:
0154 F2FC50E0      796           MOV     R12,0E050h
0158 66FCFF3F      797           AND     R12,#03FFFh
015C 7C2C          798           SHR     R12,#02h
015E 0D01          799           JMPR    cc_UC,_51
0160               800   _49:
0160 E00C          801           MOV     R12,#00h
0162               802   _51:
0162 E00D          803           MOV     R13,#00h
0164 B8C0          804           MOV     [R0],R12
0166 C4D00200      805           MOV     [R0+#02H],R13
                   806   ; main.c    391                 frequency = controller((25*raw)/4096);  //4096 ist Auflsung de
                         s ADC, links = 0, rechts = 4096
                   807           ?LINE   391
016A A840          808           MOV     R4,[R0]
016C D4500200      809           MOV     R5,[R0+#02H]
0170 E6FA1900      810           MOV     R10,#019h
0174 E00B          811           MOV     R11,#00h
0176 DA000000  R   812           CALLS   SEG __mul,__mul
017A F0C5          813           MOV     R12,R5
017C 7CC4          814           SHR     R4,#0Ch
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  16
main

 LOC CODE        LINE   SOURCELINE

017E 7CC5          815           SHR     R5,#0Ch
0180 5C4C          816           SHL     R12,#04h
0182 704C          817           OR      R4,R12
0184 F0C4          818           MOV     R12,R4
0186 DA00BC04  R   819           CALLS   SEG _controller,_controller
018A F6F40000  R   820           MOV     _frequency,R4
                   821   ; main.c    392                 CCU62_vSetTmrPeriod(CCU62_TIMER_12, calculateMotorFrequency(fre
                         quency));
                   822           ?LINE   392
018E F2FC0000  R   823           MOV     R12,_frequency
0192 DA003404  R   824           CALLS   SEG _calculateMotorFrequency,_calculateMotorFrequency
0196 F6F412EB      825           MOV     0EB12h,R4
                   826   ; main.c    393                 CCU62_vEnableShadowTransfer(CCU62_TIMER_12);
                   827           ?LINE   393
019A E6FC26EB      828           MOV     R12,#0EB26h
019E A8DC          829           MOV     R13,[R12]
01A0 6FFD          830           BSET    R13.6
01A2 B8DC          831           MOV     [R12],R13
                   832   ; main.c    394 
                   833   ; main.c    395         }
               R   834           ?SYMB   '',$,102,1
               R   835           ?SYMB   '',$,15,395
                   836           ?LINE   395
01A4               837   _31:
                   838   ; main.c    396         if (rampIndex == 0){
                   839           ?LINE   396
01A4 F2FC0000  R   840           MOV     R12,_rampIndex
01A8 3D03          841           JMPR    cc_NZ,_32
                   842   ; main.c    397                 setPhaseChange(clockwise);
                   843           ?LINE   397
01AA E00C          844           MOV     R12,#00h
01AC DA008404  R   845           CALLS   SEG _setPhaseChange,_setPhaseChange
                   846   ; main.c    398         }
                   847           ?LINE   398
01B0               848   _32:
                   849   ; main.c    399         // ramp up
                   850   ; main.c    400         if(rampIndex < 250){
                   851           ?LINE   400
01B0 F2FC0000  R   852           MOV     R12,_rampIndex
01B4 46FCFA00      853           CMP     R12,#0FAh
01B8 9D19          854           JMPR    cc_UGE,_33
                   855   ; main.c    401                 frequency = (rampIndex/5);
                   856           ?LINE   401
01BA F2FC0000  R   857           MOV     R12,_rampIndex
01BE E05D          858           MOV     R13,#05h
01C0 F6FC0EFE      859           MOV     MDL,R12
01C4 5BDD          860           DIVU    R13
01C6 F2FC0EFE      861           MOV     R12,MDL
01CA F6FC0000  R   862           MOV     _frequency,R12
                   863   ; main.c    402                 CCU62_vSetTmrPeriod(CCU62_TIMER_12, calculateMotorFrequency(fre
                         quency));
                   864           ?LINE   402
01CE F2FC0000  R   865           MOV     R12,_frequency
01D2 DA003404  R   866           CALLS   SEG _calculateMotorFrequency,_calculateMotorFrequency
01D6 F6F412EB      867           MOV     0EB12h,R4
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  17
main

 LOC CODE        LINE   SOURCELINE

                   868   ; main.c    403                 CCU62_vEnableShadowTransfer(CCU62_TIMER_12);
                   869           ?LINE   403
01DA E6FC26EB      870           MOV     R12,#0EB26h
01DE A8DC          871           MOV     R13,[R12]
01E0 6FFD          872           BSET    R13.6
01E2 B8DC          873           MOV     [R12],R13
                   874   ; main.c    404                 IO_vTogglePin(LED_DBG);
                   875           ?LINE   404
01E4 E6FC0101      876           MOV     R12,#0101h
01E8 F6FCE0E9      877           MOV     0E9E0h,R12
                   878   ; main.c    405         } 
                   879           ?LINE   405
01EC               880   _33:
                   881   ; main.c    406         // hold 50 Hz clockwise
                   882   ; main.c    407         if(rampIndex < 500 && rampIndex > 250){
                   883           ?LINE   407
01EC F2FC0000  R   884           MOV     R12,_rampIndex
01F0 46FCF401      885           CMP     R12,#01F4h
01F4 9D14          886           JMPR    cc_UGE,_34
01F6 F2FC0000  R   887           MOV     R12,_rampIndex
01FA 46FCFA00      888           CMP     R12,#0FAh
01FE FD0F          889           JMPR    cc_ULE,_35
                   890   ; main.c    408                 frequency = 50;
                   891           ?LINE   408
0200 E6FC3200      892           MOV     R12,#032h
0204 F6FC0000  R   893           MOV     _frequency,R12
                   894   ; main.c    409                 CCU62_vSetTmrPeriod(CCU62_TIMER_12, calculateMotorFrequency(fre
                         quency));
                   895           ?LINE   409
0208 F2FC0000  R   896           MOV     R12,_frequency
020C DA003404  R   897           CALLS   SEG _calculateMotorFrequency,_calculateMotorFrequency
0210 F6F412EB      898           MOV     0EB12h,R4
                   899   ; main.c    410                 CCU62_vEnableShadowTransfer(CCU62_TIMER_12);
                   900           ?LINE   410
0214 E6FC26EB      901           MOV     R12,#0EB26h
0218 A8DC          902           MOV     R13,[R12]
021A 6FFD          903           BSET    R13.6
021C B8DC          904           MOV     [R12],R13
                   905   ; main.c    411         }
                   906           ?LINE   411
021E               907   _34:
021E               908   _35:
                   909   ; main.c    412         // ramp down
                   910   ; main.c    413         if(rampIndex < 750 && rampIndex > 500){
                   911           ?LINE   413
021E F2FC0000  R   912           MOV     R12,_rampIndex
0222 46FCEE02      913           CMP     R12,#02EEh
0226 9D1C          914           JMPR    cc_UGE,_36
0228 F2FC0000  R   915           MOV     R12,_rampIndex
022C 46FCF401      916           CMP     R12,#01F4h
0230 FD17          917           JMPR    cc_ULE,_37
                   918   ; main.c    414                 frequency = (750 - rampIndex)/5;
                   919           ?LINE   414
0232 E6FCEE02      920           MOV     R12,#02EEh
0236 22FC0000  R   921           SUB     R12,_rampIndex
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  18
main

 LOC CODE        LINE   SOURCELINE

023A E05D          922           MOV     R13,#05h
023C F6FC0EFE      923           MOV     MDL,R12
0240 5BDD          924           DIVU    R13
0242 F2FC0EFE      925           MOV     R12,MDL
0246 F6FC0000  R   926           MOV     _frequency,R12
                   927   ; main.c    415                 CCU62_vSetTmrPeriod(CCU62_TIMER_12, calculateMotorFrequency(fre
                         quency));
                   928           ?LINE   415
024A F2FC0000  R   929           MOV     R12,_frequency
024E DA003404  R   930           CALLS   SEG _calculateMotorFrequency,_calculateMotorFrequency
0252 F6F412EB      931           MOV     0EB12h,R4
                   932   ; main.c    416                 CCU62_vEnableShadowTransfer(CCU62_TIMER_12);
                   933           ?LINE   416
0256 E6FC26EB      934           MOV     R12,#0EB26h
025A A8DC          935           MOV     R13,[R12]
025C 6FFD          936           BSET    R13.6
025E B8DC          937           MOV     [R12],R13
                   938   ; main.c    417         }
                   939           ?LINE   417
0260               940   _36:
0260               941   _37:
                   942   ; main.c    418         // phase change
                   943   ; main.c    419         if (rampIndex == 750){
                   944           ?LINE   419
0260 F2FC0000  R   945           MOV     R12,_rampIndex
0264 46FCEE02      946           CMP     R12,#02EEh
0268 3D03          947           JMPR    cc_NE,_38
                   948   ; main.c    420                 setPhaseChange(counterclockwise);
                   949           ?LINE   420
026A E01C          950           MOV     R12,#01h
026C DA008404  R   951           CALLS   SEG _setPhaseChange,_setPhaseChange
                   952   ; main.c    421         }
                   953           ?LINE   421
0270               954   _38:
                   955   ; main.c    422 
                   956   ; main.c    423         // reverse ramp up
                   957   ; main.c    424         if(rampIndex < 1000 && rampIndex > 750){
                   958           ?LINE   424
0270 F2FC0000  R   959           MOV     R12,_rampIndex
0274 46FCE803      960           CMP     R12,#03E8h
0278 9D1C          961           JMPR    cc_UGE,_39
027A F2FC0000  R   962           MOV     R12,_rampIndex
027E 46FCEE02      963           CMP     R12,#02EEh
0282 FD17          964           JMPR    cc_ULE,_40
                   965   ; main.c    425                 frequency = (rampIndex-750)/5;
                   966           ?LINE   425
0284 F2FC0000  R   967           MOV     R12,_rampIndex
0288 26FCEE02      968           SUB     R12,#02EEh
028C E05D          969           MOV     R13,#05h
028E F6FC0EFE      970           MOV     MDL,R12
0292 5BDD          971           DIVU    R13
0294 F2FC0EFE      972           MOV     R12,MDL
0298 F6FC0000  R   973           MOV     _frequency,R12
                   974   ; main.c    426                 CCU62_vSetTmrPeriod(CCU62_TIMER_12, calculateMotorFrequency(fre
                         quency));
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  19
main

 LOC CODE        LINE   SOURCELINE

                   975           ?LINE   426
029C F2FC0000  R   976           MOV     R12,_frequency
02A0 DA003404  R   977           CALLS   SEG _calculateMotorFrequency,_calculateMotorFrequency
02A4 F6F412EB      978           MOV     0EB12h,R4
                   979   ; main.c    427                 CCU62_vEnableShadowTransfer(CCU62_TIMER_12);
                   980           ?LINE   427
02A8 E6FC26EB      981           MOV     R12,#0EB26h
02AC A8DC          982           MOV     R13,[R12]
02AE 6FFD          983           BSET    R13.6
02B0 B8DC          984           MOV     [R12],R13
                   985   ; main.c    428         }
                   986           ?LINE   428
02B2               987   _39:
02B2               988   _40:
                   989   ; main.c    429         // hold 50 hz counterclockwise
                   990   ; main.c    430         if(rampIndex < 1250 && rampIndex > 1000){
                   991           ?LINE   430
02B2 F2FC0000  R   992           MOV     R12,_rampIndex
02B6 46FCE204      993           CMP     R12,#04E2h
02BA 9D14          994           JMPR    cc_UGE,_41
02BC F2FC0000  R   995           MOV     R12,_rampIndex
02C0 46FCE803      996           CMP     R12,#03E8h
02C4 FD0F          997           JMPR    cc_ULE,_42
                   998   ; main.c    431                 frequency = 50;
                   999           ?LINE   431
02C6 E6FC3200     1000           MOV     R12,#032h
02CA F6FC0000  R  1001           MOV     _frequency,R12
                  1002   ; main.c    432                 CCU62_vSetTmrPeriod(CCU62_TIMER_12, calculateMotorFrequency(fre
                         quency));
                  1003           ?LINE   432
02CE F2FC0000  R  1004           MOV     R12,_frequency
02D2 DA003404  R  1005           CALLS   SEG _calculateMotorFrequency,_calculateMotorFrequency
02D6 F6F412EB     1006           MOV     0EB12h,R4
                  1007   ; main.c    433                 CCU62_vEnableShadowTransfer(CCU62_TIMER_12);
                  1008           ?LINE   433
02DA E6FC26EB     1009           MOV     R12,#0EB26h
02DE A8DC         1010           MOV     R13,[R12]
02E0 6FFD         1011           BSET    R13.6
02E2 B8DC         1012           MOV     [R12],R13
                  1013   ; main.c    434         }
                  1014           ?LINE   434
02E4              1015   _41:
02E4              1016   _42:
                  1017   ; main.c    435         // reverse ramp down
                  1018   ; main.c    436         if(rampIndex < 1500 && rampIndex > 1250){
                  1019           ?LINE   436
02E4 F2FC0000  R  1020           MOV     R12,_rampIndex
02E8 46FCDC05     1021           CMP     R12,#05DCh
02EC 9D1C         1022           JMPR    cc_UGE,_43
02EE F2FC0000  R  1023           MOV     R12,_rampIndex
02F2 46FCE204     1024           CMP     R12,#04E2h
02F6 FD17         1025           JMPR    cc_ULE,_44
                  1026   ; main.c    437                 frequency = (1500 - rampIndex)/5;
                  1027           ?LINE   437
02F8 E6FCDC05     1028           MOV     R12,#05DCh
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  20
main

 LOC CODE        LINE   SOURCELINE

02FC 22FC0000  R  1029           SUB     R12,_rampIndex
0300 E05D         1030           MOV     R13,#05h
0302 F6FC0EFE     1031           MOV     MDL,R12
0306 5BDD         1032           DIVU    R13
0308 F2FC0EFE     1033           MOV     R12,MDL
030C F6FC0000  R  1034           MOV     _frequency,R12
                  1035   ; main.c    438                 CCU62_vSetTmrPeriod(CCU62_TIMER_12, calculateMotorFrequency(fre
                         quency));
                  1036           ?LINE   438
0310 F2FC0000  R  1037           MOV     R12,_frequency
0314 DA003404  R  1038           CALLS   SEG _calculateMotorFrequency,_calculateMotorFrequency
0318 F6F412EB     1039           MOV     0EB12h,R4
                  1040   ; main.c    439                 CCU62_vEnableShadowTransfer(CCU62_TIMER_12);
                  1041           ?LINE   439
031C E6FC26EB     1042           MOV     R12,#0EB26h
0320 A8DC         1043           MOV     R13,[R12]
0322 6FFD         1044           BSET    R13.6
0324 B8DC         1045           MOV     [R12],R13
                  1046   ; main.c    440         }
                  1047           ?LINE   440
0326              1048   _43:
0326              1049   _44:
                  1050   ; main.c    441         // DC break !!! adjust CCU62 rampIndex !!!
                  1051   ; main.c    442         if(rampIndex < 1750 && rampIndex > 1500){
                  1052           ?LINE   442
0326 F2FC0000  R  1053           MOV     R12,_rampIndex
032A 46FCD606     1054           CMP     R12,#06D6h
032E 9D14         1055           JMPR    cc_UGE,_45
0330 F2FC0000  R  1056           MOV     R12,_rampIndex
0334 46FCDC05     1057           CMP     R12,#05DCh
0338 FD0F         1058           JMPR    cc_ULE,_46
                  1059   ; main.c    443                 frequency = 50;
                  1060           ?LINE   443
033A E6FC3200     1061           MOV     R12,#032h
033E F6FC0000  R  1062           MOV     _frequency,R12
                  1063   ; main.c    444                 CCU62_vSetTmrPeriod(CCU62_TIMER_12, calculateMotorFrequency(fre
                         quency));
                  1064           ?LINE   444
0342 F2FC0000  R  1065           MOV     R12,_frequency
0346 DA003404  R  1066           CALLS   SEG _calculateMotorFrequency,_calculateMotorFrequency
034A F6F412EB     1067           MOV     0EB12h,R4
                  1068   ; main.c    445                 CCU62_vEnableShadowTransfer(CCU62_TIMER_12);
                  1069           ?LINE   445
034E E6FC26EB     1070           MOV     R12,#0EB26h
0352 A8DC         1071           MOV     R13,[R12]
0354 6FFD         1072           BSET    R13.6
0356 B8DC         1073           MOV     [R12],R13
                  1074   ; main.c    446         }
                  1075           ?LINE   446
0358              1076   _45:
0358              1077   _46:
                  1078   ; main.c    447         // set 0 Hz for transition to poti control
                  1079   ; main.c    448         if(rampIndex == 1750){
                  1080           ?LINE   448
0358 F2FC0000  R  1081           MOV     R12,_rampIndex
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  21
main

 LOC CODE        LINE   SOURCELINE

035C 46FCD606     1082           CMP     R12,#06D6h
0360 3D0D         1083           JMPR    cc_NE,_47
                  1084   ; main.c    449                 frequency = 0;
                  1085           ?LINE   449
0362 F68E0000  R  1086           MOV     _frequency,ZEROS
                  1087   ; main.c    450                 CCU62_vSetTmrPeriod(CCU62_TIMER_12, calculateMotorFrequency(fre
                         quency));
                  1088           ?LINE   450
0366 F2FC0000  R  1089           MOV     R12,_frequency
036A DA003404  R  1090           CALLS   SEG _calculateMotorFrequency,_calculateMotorFrequency
036E F6F412EB     1091           MOV     0EB12h,R4
                  1092   ; main.c    451                 CCU62_vEnableShadowTransfer(CCU62_TIMER_12);
                  1093           ?LINE   451
0372 E6FC26EB     1094           MOV     R12,#0EB26h
0376 A8DC         1095           MOV     R13,[R12]
0378 6FFD         1096           BSET    R13.6
037A B8DC         1097           MOV     [R12],R13
                  1098   ; main.c    452         }
                  1099           ?LINE   452
037C              1100   _47:
                  1101           ?LINE   382
037C              1102   _48:
037C EA004001  R  1103           JMPA+   cc_UC,_30
                  1104   ; main.c    453 
                  1105   ; main.c    454    // USER CODE END
                  1106   ; main.c    455 
                  1107   ; main.c    456   }
                  1108   ; main.c    457 
                  1109   ; main.c    458 } //  End of function main
                  1110           ?LINE   458
0380 0804         1111           ADD     R0,#04h
               R  1112           ?SYMB   '',$,96,0
0382 DB00         1113           RETS
                  1114   _main   ENDP
               R  1115           ?SYMB   '',$,17,458
                  1116   ; main.c    459 
                  1117   ; main.c    460 
                  1118   ; main.c    461 
                  1119   ; main.c    462 // USER CODE BEGIN (MAIN_General,10)
                  1120   ; main.c    463 void generateTable(){
                  1121           ?LINE   463
                  1122           PUBLIC  _generateTable
               R  1123           ?SYMB   'generateTable',_generateTable,37,1
                  1124           ?SYMB   '',463,8,34
                  1125   _generateTable  PROC    FAR
                  1126           ?SYMB   '',00H,95,0
0384 26F00A00     1127           SUB     R0,#0Ah
               R  1128           ?SYMB   '',$,96,10
                  1129   ; Locals:
                  1130   ;     i = offset 0
                  1131   ;     stepSize = offset 2
                  1132   ; 
                  1133   ; Statics:
                  1134   ; 
                  1135   ; CSEs:
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  22
main

 LOC CODE        LINE   SOURCELINE

                  1136   ; 
                  1137   ; main.c    464         double stepSize = (2*pi)/(ARRAY_SIZE);
                  1138           ?SYMB   'stepSize',2,98,11
               R  1139           ?SYMB   '-8',$,101,2
                  1140           ?LINE   464
0388 F2F40000  R  1141           MOV     R4,_pi
038C F2F50000  R  1142           MOV     R5,(_pi+2)
0390 E6FA0040     1143           MOV     R10,#04000h
0394 E00B         1144           MOV     R11,#00h
0396 DA000000  R  1145           CALLS   SEG __mlf4r,__mlf4r
039A E6FA9644     1146           MOV     R10,#04496h
039E E00B         1147           MOV     R11,#00h
03A0 DA000000  R  1148           CALLS   SEG __dvf4r,__dvf4r
03A4 DA000000  R  1149           CALLS   SEG __cff48r,__cff48r
               R  1150           ?SYMB   '',$,96,18
03A8 F040         1151           MOV     R4,R0
03AA 06F40A00     1152           ADD     R4,#0Ah
03AE DA000000  R  1153           CALLS   SEG __store8n,__store8n
03B2 06F00800     1154           ADD     R0,#08h
               R  1155           ?SYMB   '',$,96,10
                  1156   ; main.c    465         int i;
                  1157           ?SYMB   'i',1,98,16
               R  1158           ?SYMB   '-a',$,101,1
                  1159   ; main.c    466         for (i = 0; i < ARRAY_SIZE; i++){ 
                  1160           ?LINE   466
03B6 E00C         1161           MOV     R12,#00h
03B8 B8C0         1162           MOV     [R0],R12
03BA 0D35         1163           JMPR    cc_UC,_57
03BC              1164   _56:
                  1165   ; main.c    467                 table[i] = (unsigned int)((double)((CCU63_T12PR - 140)/2)*sin(s
                         tepSize * i) + (CCU63_T12PR/2));
                  1166           ?LINE   467
03BC 26F00800     1167           SUB     R0,#08h
               R  1168           ?SYMB   '',$,96,18
03C0 E0A4         1169           MOV     R4,#0Ah
03C2 0040         1170           ADD     R4,R0
03C4 DA000000  R  1171           CALLS   SEG __load8n,__load8n
               R  1172           ?SYMB   '',$,96,26
03C8 D4B01000     1173           MOV     R11,[R0+#010H]
03CC F04B         1174           MOV     R4,R11
03CE F0CA         1175           MOV     R12,R10
03D0 DA000000  R  1176           CALLS   SEG __cif28r,__cif28r
               R  1177           ?SYMB   '',$,96,34
03D4 F0BA         1178           MOV     R11,R10
03D6 F0AC         1179           MOV     R10,R12
03D8 DA000000  R  1180           CALLS   SEG __mlf8r,__mlf8r
03DC 06F00800     1181           ADD     R0,#08h
               R  1182           ?SYMB   '',$,96,26
03E0 DA000000  R  1183           CALLS   SEG _sin,_sin
03E4 06F00800     1184           ADD     R0,#08h
               R  1185           ?SYMB   '',$,96,18
03E8 F0B4         1186           MOV     R11,R4
03EA F2FA92EB     1187           MOV     R10,0EB92h
03EE 26FA8C00     1188           SUB     R10,#08Ch
03F2 7C1A         1189           SHR     R10,#01h
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  23
main

 LOC CODE        LINE   SOURCELINE

03F4 F04A         1190           MOV     R4,R10
03F6 DA000000  R  1191           CALLS   SEG __cuf28r,__cuf28r
               R  1192           ?SYMB   '',$,96,26
03FA DA000000  R  1193           CALLS   SEG __mlf8r,__mlf8r
03FE F0BA         1194           MOV     R11,R10
0400 F2FA92EB     1195           MOV     R10,0EB92h
0404 7C1A         1196           SHR     R10,#01h
0406 F04A         1197           MOV     R4,R10
0408 DA000000  R  1198           CALLS   SEG __cuf28r,__cuf28r
               R  1199           ?SYMB   '',$,96,34
040C DA000000  R  1200           CALLS   SEG __adf8r,__adf8r
0410 DA000000  R  1201           CALLS   SEG __cfu82r,__cfu82r
0414 06F01800     1202           ADD     R0,#018h
               R  1203           ?SYMB   '',$,96,10
0418 A8C0         1204           MOV     R12,[R0]
041A 5C1C         1205           SHL     R12,#01h
041C C44C0000  R  1206           MOV     [R12+#_table],R4
                  1207           ?LINE   466
0420 A8C0         1208           MOV     R12,[R0]
0422 08C1         1209           ADD     R12,#01h
0424 B8C0         1210           MOV     [R0],R12
0426              1211   _57:
0426 A8C0         1212           MOV     R12,[R0]
0428 46FCB004     1213           CMP     R12,#04B0h
042C 8DC7         1214           JMPR    cc_ULT,_56
                  1215   ; main.c    468         }
                  1216   ; main.c    469 }
               R  1217           ?SYMB   '',$,102,1
               R  1218           ?SYMB   '',$,102,2
                  1219           ?LINE   469
042E 06F00A00     1220           ADD     R0,#0Ah
               R  1221           ?SYMB   '',$,96,0
0432 DB00         1222           RETS
                  1223   _generateTable  ENDP
               R  1224           ?SYMB   '',$,17,469
                  1225   ; main.c    470 
                  1226   ; main.c    471 
                  1227   ; main.c    472 //calculate frequency and set frequency < 2 Hz = 0 Hz
                  1228   ; main.c    473 unsigned int calculateMotorFrequency (unsigned int _frequency){
                  1229           ?LINE   473
                  1230           PUBLIC  _calculateMotorFrequency
               R  1231           ?SYMB   'calculateMotorFrequency',_calculateMotorFrequency,37,18
                  1232           ?SYMB   '',473,8,34
                  1233   _calculateMotorFrequency        PROC    FAR
                  1234           ?SYMB   '',00H,95,0
0434 88C0         1235           MOV     [-R0],R12
               R  1236           ?SYMB   '',$,96,2
                  1237   ; Locals:
                  1238   ;     _frequency = offset 0
                  1239   ; 
                  1240   ; Statics:
                  1241   ; 
                  1242   ; CSEs:
                  1243   ; 
                  1244           ?SYMB   '_frequency',1,99,18
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  24
main

 LOC CODE        LINE   SOURCELINE

               R  1245           ?SYMB   '-2',$,101,1
                  1246   ; main.c    474         if (_frequency < 2){
                  1247           ?LINE   474
0436 A8C0         1248           MOV     R12,[R0]
0438 48C2         1249           CMP     R12,#02h
043A 9D06         1250           JMPR    cc_UGE,_62
                  1251   ; main.c    475                 frequency = 1;
                  1252           ?LINE   475
043C E01C         1253           MOV     R12,#01h
043E F6FC0000  R  1254           MOV     _frequency,R12
                  1255   ; main.c    476                 return (0xD903);
                  1256           ?LINE   476
0442 E6F403D9     1257           MOV     R4,#0D903h
0446 0D1C         1258           JMPR    cc_UC,_63
                  1259   ; main.c    477         }
                  1260           ?LINE   477
0448              1261   _62:
                  1262   ; main.c    478         else {
                  1263   ; main.c    479                 return (1/((float)_frequency * (float)ARRAY_SIZE*0.000000015));
                  1264           ?LINE   479
0448 A840         1265           MOV     R4,[R0]
044A DA000000  R  1266           CALLS   SEG __cuf24r,__cuf24r
044E E6FA9644     1267           MOV     R10,#04496h
0452 E00B         1268           MOV     R11,#00h
0454 DA000000  R  1269           CALLS   SEG __mlf4r,__mlf4r
0458 DA000000  R  1270           CALLS   SEG __cff48r,__cff48r
               R  1271           ?SYMB   '',$,96,10
045C F0BA         1272           MOV     R11,R10
045E E6F40000  R  1273           MOV     R4,#_58
0462 DA000000  R  1274           CALLS   SEG __load8n,__load8n
               R  1275           ?SYMB   '',$,96,18
0466 DA000000  R  1276           CALLS   SEG __mlf8r,__mlf8r
046A F0BA         1277           MOV     R11,R10
046C E6F40000  R  1278           MOV     R4,#_59
0470 DA000000  R  1279           CALLS   SEG __load8n,__load8n
               R  1280           ?SYMB   '',$,96,26
0474 DA000000  R  1281           CALLS   SEG __dvf8r,__dvf8r
0478 DA000000  R  1282           CALLS   SEG __cfu82r,__cfu82r
047C 06F01800     1283           ADD     R0,#018h
               R  1284           ?SYMB   '',$,96,2
                  1285   ; main.c    480         }
                  1286   ; main.c    481 }
                  1287           ?LINE   481
0480              1288   _63:
               R  1289           ?SYMB   '',$,102,1
0480 0802         1290           ADD     R0,#02h
               R  1291           ?SYMB   '',$,96,0
0482 DB00         1292           RETS
                  1293   _calculateMotorFrequency        ENDP
               R  1294           ?SYMB   '',$,17,481
                  1295   ; main.c    482 
                  1296   ; main.c    483 
                  1297   ; main.c    484 //phase change
                  1298   ; main.c    485 void setPhaseChange(int dir){
                  1299           ?LINE   485
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  25
main

 LOC CODE        LINE   SOURCELINE

                  1300           PUBLIC  _setPhaseChange
               R  1301           ?SYMB   'setPhaseChange',_setPhaseChange,37,1
                  1302           ?SYMB   '',485,8,34
                  1303   _setPhaseChange PROC    FAR
                  1304           ?SYMB   '',00H,95,0
0484 88C0         1305           MOV     [-R0],R12
               R  1306           ?SYMB   '',$,96,2
                  1307   ; Locals:
                  1308   ;     dir = offset 0
                  1309   ; 
                  1310   ; Statics:
                  1311   ; 
                  1312   ; CSEs:
                  1313   ; 
                  1314           ?SYMB   'dir',1,99,16
               R  1315           ?SYMB   '-2',$,101,1
                  1316   ; main.c    486         if(dir == clockwise){
                  1317           ?LINE   486
0486 A8C0         1318           MOV     R12,[R0]
0488 3D0A         1319           JMPR    cc_NZ,_66
                  1320   ; main.c    487                 OFFSET_L1 = 0;
                  1321           ?LINE   487
048A F68E0000  R  1322           MOV     _OFFSET_L1,ZEROS
                  1323   ; main.c    488                 OFFSET_L2 = (2*ARRAY_SIZE)/3;
                  1324           ?LINE   488
048E E6FC2003     1325           MOV     R12,#0320h
0492 F6FC0000  R  1326           MOV     _OFFSET_L2,R12
                  1327   ; main.c    489                 OFFSET_L3 = ARRAY_SIZE/3;
                  1328           ?LINE   489
0496 E6FC9001     1329           MOV     R12,#0190h
049A F6FC0000  R  1330           MOV     _OFFSET_L3,R12
                  1331   ; main.c    490         }
                  1332           ?LINE   490
049E              1333   _66:
                  1334   ; main.c    491         if(dir == counterclockwise){
                  1335           ?LINE   491
049E A8C0         1336           MOV     R12,[R0]
04A0 48C1         1337           CMP     R12,#01h
04A2 3D0A         1338           JMPR    cc_NE,_67
                  1339   ; main.c    492                 OFFSET_L1 = 0;
                  1340           ?LINE   492
04A4 F68E0000  R  1341           MOV     _OFFSET_L1,ZEROS
                  1342   ; main.c    493                 OFFSET_L2 = ARRAY_SIZE/3;
                  1343           ?LINE   493
04A8 E6FC9001     1344           MOV     R12,#0190h
04AC F6FC0000  R  1345           MOV     _OFFSET_L2,R12
                  1346   ; main.c    494                 OFFSET_L3 = (2*ARRAY_SIZE)/3;
                  1347           ?LINE   494
04B0 E6FC2003     1348           MOV     R12,#0320h
04B4 F6FC0000  R  1349           MOV     _OFFSET_L3,R12
                  1350   ; main.c    495         }  
                  1351           ?LINE   495
04B8              1352   _67:
                  1353   ; main.c    496 }
               R  1354           ?SYMB   '',$,102,1
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  26
main

 LOC CODE        LINE   SOURCELINE

                  1355           ?LINE   496
04B8 0802         1356           ADD     R0,#02h
               R  1357           ?SYMB   '',$,96,0
04BA DB00         1358           RETS
                  1359   _setPhaseChange ENDP
               R  1360           ?SYMB   '',$,17,496
                  1361   ; main.c    497 
                  1362   ; main.c    498 //controller
                  1363   ; main.c    499 unsigned int controller(int input){
                  1364           ?LINE   499
                  1365           PUBLIC  _controller
               R  1366           ?SYMB   'controller',_controller,37,18
                  1367           ?SYMB   '',499,8,34
                  1368   _controller     PROC    FAR
                  1369           ?SYMB   '',00H,95,0
04BC 88C0         1370           MOV     [-R0],R12
               R  1371           ?SYMB   '',$,96,2
04BE 2804         1372           SUB     R0,#04h
               R  1373           ?SYMB   '',$,96,6
                  1374   ; Locals:
                  1375   ;     manipulated_variable = offset 0
                  1376   ;     controller_error = offset 2
                  1377   ;     input = offset 4
                  1378   ; 
                  1379   ; Statics:
                  1380   ; 
                  1381   ; CSEs:
                  1382   ; 
                  1383           ?SYMB   'input',3,99,16
               R  1384           ?SYMB   '-2',$,101,3
                  1385   ; main.c    500         //Regelabweichung = mech Drehzahldifferenz
                  1386   ; main.c    501         int controller_error = input - velocity;        // velocity =^ output/ 
                         feedback
                  1387           ?SYMB   'controller_error',2,98,16
               R  1388           ?SYMB   '-4',$,101,2
                  1389           ?LINE   501
04C0 F2FA0000  R  1390           MOV     R10,_velocity
04C4 F2FB0000  R  1391           MOV     R11,(_velocity+2)
04C8 D4400400     1392           MOV     R4,[R0+#04H]
04CC DA000000  R  1393           CALLS   SEG __cif24r,__cif24r
04D0 DA000000  R  1394           CALLS   SEG __sbf4r,__sbf4r
04D4 DA000000  R  1395           CALLS   SEG __cfi42r,__cfi42r
04D8 C4400200     1396           MOV     [R0+#02H],R4
                  1397   ; main.c    502         //P-Regler
                  1398   ; main.c    503         int manipulated_variable = controller_error * K_p;
                  1399           ?SYMB   'manipulated_variable',1,98,16
               R  1400           ?SYMB   '-6',$,101,1
                  1401           ?LINE   503
04DC F2F40000  R  1402           MOV     R4,_K_p
04E0 F2F50000  R  1403           MOV     R5,(_K_p+2)
04E4 F0C4         1404           MOV     R12,R4
04E6 D4400200     1405           MOV     R4,[R0+#02H]
04EA F0D5         1406           MOV     R13,R5
04EC DA000000  R  1407           CALLS   SEG __cif24r,__cif24r
04F0 F0BD         1408           MOV     R11,R13
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  27
main

 LOC CODE        LINE   SOURCELINE

04F2 F0AC         1409           MOV     R10,R12
04F4 DA000000  R  1410           CALLS   SEG __mlf4r,__mlf4r
04F8 DA000000  R  1411           CALLS   SEG __cfi42r,__cfi42r
04FC B840         1412           MOV     [R0],R4
                  1413   ; main.c    504         //I-Regler
                  1414   ; main.c    505         integral_sum = integral_sum + controller_error; //so gehts auch: integr
                         al_sum += controller_error
                  1415           ?LINE   505
04FE D4C00200     1416           MOV     R12,[R0+#02H]
0502 02FC0000  R  1417           ADD     R12,_integral_sum
0506 F6FC0000  R  1418           MOV     _integral_sum,R12
                  1419   ; main.c    506         //if (integral_sum > windup){
                  1420   ; main.c    507         // } 
                  1421   ; main.c    508         //P- + I-Regler
                  1422   ; main.c    509         manipulated_variable = manipulated_variable + K_i * integral_sum;
                  1423           ?LINE   509
050A F2F40000  R  1424           MOV     R4,_K_i
050E F2F50000  R  1425           MOV     R5,(_K_i+2)
0512 F0C4         1426           MOV     R12,R4
0514 F2F40000  R  1427           MOV     R4,_integral_sum
0518 F0D5         1428           MOV     R13,R5
051A DA000000  R  1429           CALLS   SEG __cif24r,__cif24r
051E F0BD         1430           MOV     R11,R13
0520 F0AC         1431           MOV     R10,R12
0522 DA000000  R  1432           CALLS   SEG __mlf4r,__mlf4r
0526 F0C4         1433           MOV     R12,R4
0528 A840         1434           MOV     R4,[R0]
052A F0D5         1435           MOV     R13,R5
052C DA000000  R  1436           CALLS   SEG __cif24r,__cif24r
0530 F0BD         1437           MOV     R11,R13
0532 F0AC         1438           MOV     R10,R12
0534 DA000000  R  1439           CALLS   SEG __adf4r,__adf4r
0538 DA000000  R  1440           CALLS   SEG __cfi42r,__cfi42r
053C B840         1441           MOV     [R0],R4
                  1442   ; main.c    510         //Vorsteuerung
                  1443   ; main.c    511         manipulated_variable += input*2;
                  1444           ?LINE   511
053E D4C00400     1445           MOV     R12,[R0+#04H]
0542 5C1C         1446           SHL     R12,#01h
0544 A8D0         1447           MOV     R13,[R0]
0546 00DC         1448           ADD     R13,R12
0548 B8D0         1449           MOV     [R0],R13
                  1450   ; main.c    512         //Stellgrenbegrenzung
                  1451   ; main.c    513         if(manipulated_variable > 55){
                  1452           ?LINE   513
054A A8C0         1453           MOV     R12,[R0]
054C 46FC3700     1454           CMP     R12,#037h
0550 BD04         1455           JMPR    cc_SLE,_71
                  1456   ; main.c    514                 manipulated_variable = 55;
                  1457           ?LINE   514
0552 E6FC3700     1458           MOV     R12,#037h
0556 B8C0         1459           MOV     [R0],R12
                  1460   ; main.c    515         }
                  1461           ?LINE   515
0558 0D05         1462           JMPR    cc_UC,_73
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  28
main

 LOC CODE        LINE   SOURCELINE

055A              1463   _71:
                  1464   ; main.c    516         else if(manipulated_variable < 0){
                  1465           ?LINE   516
055A A8C0         1466           MOV     R12,[R0]
055C 48C0         1467           CMP     R12,#00h
055E DD02         1468           JMPR    cc_SGE,_72
                  1469   ; main.c    517                 manipulated_variable = 1;
                  1470           ?LINE   517
0560 E01C         1471           MOV     R12,#01h
0562 B8C0         1472           MOV     [R0],R12
                  1473   ; main.c    518         }
                  1474           ?LINE   518
0564              1475   _72:
                  1476   ; main.c    519         return(manipulated_variable);
                  1477           ?LINE   519
0564              1478   _73:
0564 A840         1479           MOV     R4,[R0]
                  1480   ; main.c    520 }
               R  1481           ?SYMB   '',$,102,1
               R  1482           ?SYMB   '',$,102,2
               R  1483           ?SYMB   '',$,102,3
                  1484           ?LINE   520
0566 0806         1485           ADD     R0,#06h
               R  1486           ?SYMB   '',$,96,0
0568 DB00         1487           RETS
                  1488   _controller     ENDP
               R  1489           ?SYMB   '',$,17,520
                  1490   ; main.c    521 
                  1491   ; main.c    522 // USER CODE END
                  1492   ; main.c    523 
                  1493   MAIN_4_PR       ENDS
                  1494   
                  1495   MAIN_5_NB       SECTION LDAT WORD PUBLIC 'CNEAR'
0000              1496   MAIN_5_NB_ENTRY LABEL   BYTE
0000              1497   _table  LABEL   WORD
0000              1498           DS      2400
                  1499           PUBLIC  _table
                  1500           ?SYMB   '',01210012H,5,288
                  1501           ?SYMB   '',16,47,289
                  1502           ?SYMB   '',0,30,0
                  1503           ?SYMB   '',1199,49,0
               R  1504           ?SYMB   'table',_table,22,288
0960              1505   _integral_sum   LABEL   WORD
0960              1506           DS      2
                  1507           PUBLIC  _integral_sum
               R  1508           ?SYMB   'integral_sum',_integral_sum,22,16
0962              1509   _rpm    LABEL   WORD
0962              1510           DS      4
                  1511           PUBLIC  _rpm
               R  1512           ?SYMB   'rpm',_rpm,22,10
0966              1513   _velocity       LABEL   WORD
0966              1514           DS      4
                  1515           PUBLIC  _velocity
               R  1516           ?SYMB   'velocity',_velocity,22,10
096A              1517   _rampIndex      LABEL   WORD
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  29
main

 LOC CODE        LINE   SOURCELINE

096A              1518           DS      2
                  1519           PUBLIC  _rampIndex
               R  1520           ?SYMB   'rampIndex',_rampIndex,22,18
096C              1521   _index  LABEL   WORD
096C              1522           DS      2
                  1523           PUBLIC  _index
               R  1524           ?SYMB   'index',_index,22,18
096E              1525   _OFFSET_L1      LABEL   WORD
096E              1526           DS      2
                  1527           PUBLIC  _OFFSET_L1
               R  1528           ?SYMB   'OFFSET_L1',_OFFSET_L1,22,18
0970              1529   _OFFSET_L3      LABEL   WORD
0970              1530           DS      2
                  1531           PUBLIC  _OFFSET_L3
               R  1532           ?SYMB   'OFFSET_L3',_OFFSET_L3,22,18
0972              1533   _OFFSET_L2      LABEL   WORD
0972              1534           DS      2
                  1535           PUBLIC  _OFFSET_L2
               R  1536           ?SYMB   'OFFSET_L2',_OFFSET_L2,22,18
                  1537   MAIN_5_NB       ENDS
                  1538   
                  1539   MAIN_6_CO       SECTION LDAT WORD PUBLIC 'CROM'
0000              1540   _58     LABEL   WORD
0000 503E2B1B     1541           DW      03E50h,01B2Bh,029A4h,0692Bh
0004 A4292B69    
0008              1542   _59     LABEL   WORD
0008 F03F0000     1543           DW      03FF0h,00h,00h,00h
000C 00000000    
                  1544   MAIN_6_CO       ENDS
                  1545   
                  1546   C166_US SECTION LDAT WORD GLBUSRSTACK 'CUSTACK'
0000              1547           DS      76
                  1548   C166_US ENDS
                  1549   
                  1550   C166_INIT       SECTION PDAT WORD GLOBAL 'CINITROM'
0000 0600         1551           DW      06h
0002 00000000  R  1552           DPPTR   MAIN_ID_NB_ENTRY,MAIN_IR_NB_ENTRY
0006 00000000    
000A 0600         1553           DW      06h
                  1554   C166_INIT       ENDS
                  1555   
                  1556   C166_BSS        SECTION PDAT WORD GLOBAL 'CINITROM'
0000 05000000  R  1557           DW      05h,MAIN_5_NB_ENTRY,0974h
0004 7409        
                  1558   C166_BSS        ENDS
                  1559   
                  1560   $FLOAT(ANSI)
                  1561           EXTERN  _ADC0_vStartSeq0ReqChNum:FAR
                  1562           EXTERN  _CCU62_vInit:FAR
                  1563           EXTERN  _CCU63_vInit:FAR
                  1564           EXTERN  _sin:FAR
                  1565           EXTERN  _SCS_SwitchToHighPrecBandgap:FAR
                  1566           EXTERN  _SCS_StartXtalOsc:FAR
                  1567           EXTERN  _IO_vInit:FAR
                  1568           EXTERN  _GPT2_vInit:FAR
TASKING C166/ST10 assembler v8.7r1 Build 306                                Date: Sep 29 2021  Time: 14:42:46  Page:  30
main

 LOC CODE        LINE   SOURCELINE

                  1569           EXTERN  _GPT1_vInit:FAR
                  1570           EXTERN  _SCS_SwitchSystemClock:FAR
                  1571           EXTERN  _ADC0_vInit:FAR
                  1572           EXTERN  __mul:FAR
                  1573           EXTERN  __mlf4r:FAR
                  1574           EXTERN  __dvf4r:FAR
                  1575           EXTERN  __cff48r:FAR
                  1576           EXTERN  __store8n:FAR
                  1577           EXTERN  __load8n:FAR
                  1578           EXTERN  __cif28r:FAR
                  1579           EXTERN  __mlf8r:FAR
                  1580           EXTERN  __cuf28r:FAR
                  1581           EXTERN  __adf8r:FAR
                  1582           EXTERN  __cfu82r:FAR
                  1583           EXTERN  __cuf24r:FAR
                  1584           EXTERN  __dvf8r:FAR
                  1585           EXTERN  __cif24r:FAR
                  1586           EXTERN  __sbf4r:FAR
                  1587           EXTERN  __cfi42r:FAR
                  1588           EXTERN  __adf4r:FAR
                  1589           EXTERN  __CSTART:FAR
                  1590           REGDEF  R0-R15
                  1591           END

total errors: 0, warnings: 0

